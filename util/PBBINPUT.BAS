'$INCLUDE: 'KeyInput.BI'

10DIM B%(15,19),B$(15,1),T%(35),L%(6),Q$(377),teamItems$(500),V%(500),T$(4)

20 P$(0)="G":P$(1)="F":P$(2)="C"

55 ON ERROR GOTO 0

60 CLS:COLOR 12:PRINT TAB(30); "TEAM MANAGEMENT MENU"

61 PRINT
	COLOR 14:PRINT"(0)";:COLOR 15:PRINT " INPUT DATA FOR A NEW TEAM":PRINT
	COLOR 14:PRINT"(1)";:COLOR 15:PRINT " CHANGE DATA FOR AN EXISTING TEAM":PRINT
	COLOR 14:PRINT"(2)";:COLOR 15:PRINT " PRINT A TEAM ROSTER":PRINT
	COLOR 14:PRINT"(3)";:COLOR 15:PRINT " RETURN TO MAIN MENU"

70 I$=GetKeyPress$

80 Q=VAL(I$):IF Q<0 OR Q>3 THEN 60

90 IF Q=3 THEN CLS:RUN "UTIL.EXE":END

95 ON ERROR GOTO 0

99 IF Q>0 THEN 1435

100 CLS:PRINT:COLOR 12:PRINT "DO YOU HAVE THE FOLLOWING INFORMATION :"

102 PRINT:COLOR 14:PRINT"(1) ";:COLOR 15:PRINT "TEAM/INDIVID STEALS ";:GOSUB 4000:PRINT I$:ST=I

103 PRINT:COLOR 14:PRINT"(2) ";:COLOR 15:PRINT "TEAM/INDIVID BLOCKS ";:GOSUB 4000:PRINT I$:BK=I

104 PRINT:COLOR 14:PRINT"(3) ";:COLOR 15:PRINT "TEAM/INDIVID OFF/DEF REB ";:GOSUB 4000:PRINT I$:RB=I

105 PRINT:COLOR 14:PRINT"(4) ";:COLOR 15:PRINT "TEAM TURNOVERS ";:GOSUB 4000:PRINT I$:T0=I

106 PRINT:PRINT"ANY CHANGE (YN)";:GOSUB 4000

107 IF I=1 THEN 100

110 CLS:COLOR 14:PRINT"LEAGUE INFORMATION":COLOR 15

120 LOCATE 3:INPUT "1. NUMBER OF GAMES ";L%(0):IF C1=1 THEN 190

130 LOCATE 4:INPUT "2. AVG FGA/G ";L%(1):IF C1=1 THEN 190

140 LOCATE 5:INPUT "3. AVG RB/G ";L%(2):IF C1=1 THEN 190

150 LOCATE 6:INPUT "4. LEAGUE FG% ";L%(3):IF C1=1 THEN 190

160 LOCATE 7:INPUT "5. AVG PF/G ";L%(4):IF C1=1 THEN 190

170 LOCATE 8:INPUT "6. LEAGUE 3FG% ";L%(5):IF C1=1 THEN 190

171 LOCATE 9:INPUT "7. LEAGUE POWER ADJ ";L%(6):IF C1=1 THEN 190

172 LOCATE 10:INPUT "8. DISK ID ";YN$:IF C1=1 THEN 190
'173 LOCATE 11:INPUT "9. TEAM NUMBER ";T:IF C1=1 THEN 190

190 C1=1:LOCATE 13:INPUT"# TO CHANGE (0 TO CONTINUE) ";B9:ON B9 GOTO 120,130,140,150,160,170,171,172

195 C1=0:IF X%>0 THEN 700

196 C1=0

200 CLS:COLOR 14:PRINT"TEAM INFORMATION":COLOR 15

205 LOCATE 2:INPUT "1. TEAM NAME ";T$(0):IF C1=1 THEN 250

210 LOCATE 3:INPUT "2. TEAM NICKNAME ";T$(1):IF C1=1 THEN 250

215 LOCATE 4:INPUT "3. TEAM GAMES PLAYED ";T%(0):IF C1=1 THEN 250

220 LOCATE 5:INPUT "4. HOME WINS ";T%(1):IF C1=1 THEN 250

225 LOCATE 6:INPUT "5. HOME LOSSES ";T%(2):IF C1=1 THEN 250

230 LOCATE 7:INPUT "6. ROAD WINS ";T%(3):IF C1=1 THEN 250

235 LOCATE 8:INPUT "7. ROAD LOSSES ";T%(4):IF C1=1 THEN 250

240 LOCATE 9:INPUT "8. TEXT COLOR (0-15) ";T%(33):IF C1=1 THEN 250

245 LOCATE 10:INPUT"9. BCKGRND COLOR (0-7) ";T%(34):IF C1=1 THEN 250

246 LOCATE 11:INPUT "10. TEAM ABBREV (IE. BOS) ";T$(2):IF C1=1 THEN 250

247 LOCATE 12:INPUT "11. COACH'S NAME ";T$(3):IF C1=1 THEN 250

248 LOCATE 13:INPUT "12. ARENA NAME ";T$(4):IF C1=1 THEN 250

250 LOCATE 15:COLOR T%(33),T%(34):PRINT"SAMPLE TEXT":COLOR 15,0

255 C1=1:LOCATE 17:INPUT "# TO CHANGE (0 TO CONTINUE) ";B9:ON B9 GOTO 205,210,215,220,225,230,235,240,245,246,247,248

258 C1=0:IF X%>0 THEN 760

260 CLS:COLOR 14:PRINT "TEAM OFFENSIVE INFORMATION":COLOR 15

265 LOCATE 2:INPUT  " 1. FGM ";T%(6):IF C1=1 THEN 335

270 LOCATE 3:INPUT  " 2. FGA ";T%(5):IF C1=1 THEN 335

275 LOCATE 4:INPUT  " 3. FTM ";T%(8):IF C1=1 THEN 335

280 LOCATE 5:INPUT  " 4. FTA ";T%(7):IF C1=1 THEN 335

285 LOCATE 6:INPUT  " 5. OFF REB ";T%(9):IF C1=1 THEN 335

290 LOCATE 7:INPUT  " 6. DEF REB ";T%(10):IF C1=1 THEN 335

291 IF T%(9)=0 AND RB=0 THEN T%(9)=.32*T%(10):T%(10)=T%(10)-T%(9):LOCATE 6:PRINT  " 5. OFF REB ";T%(9):LOCATE 7:PRINT  " 6. DEF REB ";T%(10)

295 LOCATE 8:INPUT  " 7. ASSISTS ";T%(11):IF C1=1 THEN 335

300 LOCATE 9:INPUT  " 8. FOULS ";T%(12):IF C1=1 THEN 335

305 LOCATE 10:INPUT " 9. DISQ ";T%(13):IF C1=1 THEN 335

310 LOCATE 11:INPUT "10. STEALS ";T%(14):IF C1=1 THEN 335

315 LOCATE 12:INPUT "11. TURNOVERS ";T%(15):IF C1=1 THEN 335

320 LOCATE 13:INPUT "12. BLK SHOTS ";T%(16):IF C1=1 THEN 335

325 LOCATE 14:INPUT "13. 3-FGM ";T%(18):IF C1=1 THEN 335

330 LOCATE 15:INPUT "14. 3-FGA ";T%(17):IF C1=1 THEN 335

335 C1=1:LOCATE 17:INPUT "# TO CHANGE (0 TO CONTINUE) ";B9:ON B9 GOTO 265,270,275,280,285,290,295,300,305,310,315,320,325,330

336 C1=0:IF X%>0 THEN 840

340 CLS:COLOR 14:PRINT "TEAM DEFENSIVE INFORMATION":COLOR 15

345 LOCATE 2:INPUT  " 1. FGM ";T%(20):IF C1=1 THEN 415

350 LOCATE 3:INPUT  " 2. FGA ";T%(19):IF C1=1 THEN 415

355 LOCATE 4:INPUT  " 3. FTM ";T%(22):IF C1=1 THEN 415

360 LOCATE 5:INPUT  " 4. FTA ";T%(21):IF C1=1 THEN 415

365 LOCATE 6:INPUT  " 5. OFF REB ";T%(23):IF C1=1 THEN 415

370 LOCATE 7:INPUT  " 6. DEF REB ";T%(24):IF C1=1 THEN 415

371 IF T%(23)=0 AND RB=0 THEN T%(23)=.35*T%(24):T%(24)=T%(24)-T%(23):LOCATE 6:PRINT  " 5. OFF REB ";T%(23):LOCATE 7:PRINT  " 6. DEF REB ";T%(24)

375 LOCATE 8:INPUT  " 7. ASSISTS ";T%(25):IF C1=1 THEN 415

380 LOCATE 9:INPUT  " 8. FOULS ";T%(26):IF C1=1 THEN 415

385 LOCATE 10:INPUT " 9. DISQ ";T%(27):IF C1=1 THEN 415

390 LOCATE 11:INPUT "10. STEALS ";T%(28):IF C1=1 THEN 415

395 LOCATE 12:INPUT "11. TURNOVERS ";T%(29):IF C1=1 THEN 415

400 LOCATE 13:INPUT "12. BLK SHOTS ";T%(30):IF C1=1 THEN 415

405 LOCATE 14:INPUT "13. 3-FGM ";T%(32):IF C1=1 THEN 415

410 LOCATE 15:INPUT "14. 3-FGA ";T%(31):IF C1=1 THEN 415

415 C1=1:LOCATE 17:INPUT "# TO CHANGE (0 TO CONTINUE) ";B9:ON B9 GOTO 345,350,355,360,365,370,375,380,385,390,395,400,405,410

416 C1=0:IF X%>0 THEN 920

417 IF T%(28)=0 AND ST=0 THEN T%(28)=T%(5)*.1

418 IF T%(14)=0 AND ST=0 THEN T%(14)=T%(19)*.1

419 IF T%(16)=0 AND BK=0 THEN T%(16)=T%(19)*.06

420 IF T%(30)=0 AND BK=0 THEN T%(30)=T%(5)*.06

421 FOR I=0 TO 14:CLS

422 COLOR 14:PRINT TAB(25); "PLAYER INFORMATION FOR PLAYER "I+1:COLOR 15

424 LOCATE 2:INPUT " 1. NAME (END TO QUIT) ";B$(I,0):IF C1=1 THEN 520

425 IF B$(I,0)="END" THEN FOR I=I TO 14:B$(I,0)="XXX":B$(I,1)="X":FOR I1=0 TO 19:B%(I,I1)=-1:NEXT:NEXT:GOTO 600

426 LOCATE 3:INPUT  " 2. POSITION ";B$(I,1):IF C1=1 THEN 520

430 LOCATE 4:INPUT  " 3. GAMES ";B%(I,0):IF C1=1 THEN 520

435 LOCATE 5:INPUT  " 4. MINUTES ";B%(I,1):IF C1=1 THEN 520

440 LOCATE 6:INPUT  " 5. FGM ";B%(I,3):IF C1=1 THEN 520

445 LOCATE 7:INPUT  " 6. FGA ";B%(I,2):IF C1=1 THEN 520

450 LOCATE 8:INPUT  " 7. FTM ";B%(I,5):IF C1=1 THEN 520

455 LOCATE 9:INPUT  " 8. FTA ";B%(I,4):IF C1=1 THEN 520

460 LOCATE 10:INPUT " 9. OFF REB ";B%(I,6):IF C1=1 THEN 520

465 LOCATE 11:INPUT "10. DEF REB ";B%(I,7):IF C1=1 THEN 520

466 IF B%(I,6)=0 AND RB=0 THEN B%(I,6)=.32*B%(I,7):B%(I,7)=B%(I,7)-B%(I,6):LOCATE 10:PRINT " 9. OFF REB ";B%(I,6):LOCATE 11:PRINT "10. DEF REB ";B%(I,7)

470 LOCATE 12:INPUT "11. ASSISTS ";B%(I,8):IF C1=1 THEN 520

475 LOCATE 13:INPUT "12. FOULS ";B%(I,9):IF C1=1 THEN 520

480 LOCATE 14:INPUT "13. DISQ ";B%(I,10):IF C1=1 THEN 520

481 IF ST=1 THEN 485

482 IF LEFT$(B$(I,1),1)="C" THEN B%(I,11)=B%(I,1)/48*1.2:GOSUB 4010:GOTO 486

483 IF LEFT$(B$(I,1),1)="F" THEN B%(I,11)=B%(I,1)/48*1.55:GOSUB 4010:GOTO 486

484 IF LEFT$(B$(I,1),1)="G" THEN B%(I,11)=B%(I,1)/48*2.3:GOSUB 4010:GOTO 486

485 LOCATE 15:INPUT "14. STEALS   ";B%(I,11):IF C1=1 THEN 520

486 IF BK=1 THEN 490

487 IF LEFT$(B$(I,1),1)="C" THEN B%(I,12)=B%(I,1)/48*2.5:GOSUB 4015:GOTO 495

488 IF LEFT$(B$(I,1),1)="F" THEN B%(I,12)=B%(I,1)/48*1.2:GOSUB 4015:GOTO 495

489 IF LEFT$(B$(I,1),1)="G" THEN B%(I,12)=B%(I,1)/48*.4:GOSUB 4015:GOTO 495

490 LOCATE 16:INPUT "15. BLOCKS ";B%(I,12):IF C1=1 THEN 520

495 LOCATE 17:INPUT "16. 3-FGM ";B%(I,14):IF C1=1 THEN 520

500 LOCATE 18:INPUT "17. 3-FGA ";B%(I,13):IF C1=1 THEN 520

505 LOCATE 19:INPUT "18. HI-GAME ";B%(I,15):IF C1=1 THEN 520

510 'LOCATE 20:INPUT "19. PENETRATION (1-9) ";B%(I,16):IF C1=1 THEN 520

515 'LOCATE 21:INPUT "20. DEF ADJ (-5 TO 5) ";B%(I,17):IF C1=1 THEN 520

516 LOCATE 22:INPUT "21. ACTIVE FLAG (0-YES 1-NO) ";B%(I,18):IF C1=1 THEN 520

520 C1=1:LOCATE 23:PRINT "# TO CHANGE (0 TO CONTINUE)";:INPUT B9

525 ON B9 GOTO 424,426,430,435,440,445,450,455,460,465,470,475,480,485,490,495,500,505,520,520,516

530 C1=0:IF X%>0 THEN 920

535 NEXT I

600 CLS:COLOR 14:PRINT"CHANGE LEAGUE INFORMATION":X%=2:COLOR 15:PRINT

620 PRINT "1. NUMBER OF GAMES ";L%(0)

630 PRINT "2. AVG FGA/G ";L%(1)

640 PRINT "3. AVG RB/G ";L%(2)

650 PRINT "4. LEAGUE FG% ";L%(3)

660 PRINT "5. AVG PF/G ";L%(4)

670 PRINT "6. LEAGUE 3FG% ";L%(5)

671 PRINT "7. LEAGUE POWER ADJ ";L%(6)

672 PRINT "8. DISK ID ";YN$
	PRINT "9. TEAM NUMBER ";T

680 GOTO 190

700 CLS:COLOR 14:PRINT"CHANGE TEAM INFORMATION":COLOR 15

705 PRINT "1. TEAM NAME ";T$(0)

710 PRINT "2. TEAM NICKNAME ";T$(1)

715 PRINT "3. TEAM GAMES PLAYED ";T%(0)

720 PRINT "4. HOME WINS ";T%(1)

725 PRINT "5. HOME LOSSES ";T%(2)

730 PRINT "6. ROAD WINS ";T%(3)

735 PRINT "7. ROAD LOSSES ";T%(4)

740 PRINT "8. TEXT COLOR (0-15) ";T%(33)

745 PRINT "9. BCKGRND COLOR (0-7) ";T%(34)
	PRINT "10. TEAM ABBREV (IE. BOS) ";T$(2)
	PRINT "11. COACH'S NAME ";T$(3)
	PRINT "12. ARENA NAME ";T$(4)

750 LOCATE 15:COLOR T%(33),T%(34):PRINT"SAMPLE TEXT":COLOR 15,0

755 GOTO 255

760 CLS:COLOR 14:PRINT "CHANGE TEAM OFFENSIVE INFORMATION":X%=2:COLOR 15

765 PRINT " 1. FGM ";T%(6)

770 PRINT " 2. FGA ";T%(5)

775 PRINT " 3. FTM ";T%(8)

780 PRINT " 4. FTA ";T%(7)

785 PRINT " 5. OFF REB ";T%(9)

790 PRINT " 6. DEF REB ";T%(10)

795 PRINT " 7. ASSISTS ";T%(11)

800 PRINT " 8. FOULS ";T%(12)

805 PRINT " 9. DISQ ";T%(13)

810 PRINT "10. STEALS ";T%(14)

815 PRINT "11. TURNOVERS ";T%(15)

820 PRINT "12. BLK SHOTS ";T%(16)

825 PRINT "13. 3-FGM ";T%(18)

830 PRINT "14. 3-FGA ";T%(17)

835 GOTO 335

840 CLS:COLOR 14:PRINT "CHANGE TEAM DEFENSIVE INFORMATION":X%=2:COLOR 15

845 PRINT " 1. FGM ";T%(20)

850 PRINT " 2. FGA ";T%(19)

855 PRINT " 3. FTM ";T%(22)

860 PRINT " 4. FTA ";T%(21)

865 PRINT " 5. OFF REB ";T%(23)

870 PRINT " 6. DEF REB ";T%(24)

875 PRINT " 7. ASSISTS ";T%(25)

880 PRINT " 8. FOULS ";T%(26)

885 PRINT " 9. DISQ ";T%(27)

890 PRINT "10. STEALS ";T%(28)

895 PRINT "11. TURNOVERS ";T%(29)

900 PRINT "12. BLK SHOTS ";T%(30)

905 PRINT "13. 3-FGM ";T%(32)

910 PRINT "14. 3-FGA ";T%(31)

915 GOTO 415

920 CLS:COLOR 14:PRINT "CHANGE PLAYER STATS":X%=2:COLOR 15
	FOR I=0 TO 14:PRINT USING "##";I+1;:PRINT "  "B$(I,0)

930 NEXT:PRINT:PRINT"# TO CHANGE (1-15) (0 TO CONTINUE) ";:INPUT I

935 LOCATE 1,1:IF I=0 THEN X%=0:GOTO 1380

940 I=I-1:LOCATE 1,1

960 CLS:COLOR 14:PRINT TAB(31); "CHANGE PLAYER INFORMATION":COLOR 15

964 PRINT  " 1. NAME (END TO QUIT) ";B$(I,0)

966 PRINT  " 2. POSITION ";B$(I,1)

970 PRINT  " 3. GAMES ";B%(I,0)

975 PRINT  " 4. MINUTES ";B%(I,1)

980 PRINT  " 5. FGM ";B%(I,3)

985 PRINT  " 6. FGA ";B%(I,2)

990 PRINT  " 7. FTM ";B%(I,5)

995 PRINT  " 8. FTA ";B%(I,4)

1000 PRINT " 9. OFF REB ";B%(I,6)

1005 PRINT "10. DEF REB ";B%(I,7)

1010 PRINT "11. ASSISTS ";B%(I,8)

1015 PRINT "12. FOULS ";B%(I,9)

1020 PRINT "13. DISQ ";B%(I,10)

1025 PRINT "14. STEALS ";B%(I,11)

1030 PRINT "15. BLOCKS ";B%(I,12)

1035 PRINT "16. 3-FGM ";B%(I,14)

1040 PRINT "17. 3-FGA ";B%(I,13)

1045 PRINT "18. HI-GAME ";B%(I,15)

1050 PRINT:'PRINT "19. PENETRATION (1-9) ";B%(I,16)

1055 PRINT:'PRINT "20. DEF ADJ (-5 TO 5) ";B%(I,17)

1056 PRINT "21. ACTIVE FLAG (0-YES 1-NO) ";B%(I,18)

1060 GOTO 520

1100 NT=0
	ON ERROR GOTO 2060

OPEN D$(0)+"PROBBTMS."+YN$ FOR INPUT AS #1
CLOSE 1

OPEN D$(0)+"PROBBTMS."+YN$ AS #1 LEN=1031
	Y=LOF(1)
	FIELD #1,15 AS Q$(0),15 AS Q$(1)
	FOR I=0 TO 6
	FIELD #1,30+I*2 AS X$,2 AS Q$(I+2)
	NEXT
	FIELD #1,44 AS X$,2 AS Q$(9)
	FOR I=0 TO 34
	FIELD #1,46+I*2 AS X$,2 AS Q$(I+10)
	NEXT
	FOR I=0 TO 14
	FIELD #1,116+I*57 AS X$,15 AS Q$(I*22+45),2 AS Q$(I*22+46)
	FOR I1=0 TO 19
	FIELD #1,133+I*57+I1*2 AS X$,2 AS Q$(I*22+47+I1)
	NEXT
	NEXT
	FIELD #1,971 AS X$,5 AS Q$(375),15 AS Q$(376),40 AS Q$(377)
	FOR I1=1 TO Y/1031
	GET #1,I1
	CK%=CVI(Q$(9))
	IF CK%<>999 THEN 1103
	NT=NT+1
	teamItems$(NT)=Q$(0):V%(NT)=I1
1103 NEXT
CLOSE 1

TS%=INT((NT-1)/80)

1102 SS%=0

1101 COLOR ,4:CLS:LOCATE ,33:COLOR 14:PRINT "TEAM SELECTION":COLOR 15
	FOR X=1 TO 20
	LOCATE 3+X,1:PRINT teamItems$(SS%*80+X);
	LOCATE ,21:PRINT teamItems$(SS%*80+20+X);
	LOCATE ,41:PRINT teamItems$(SS%*80+40+X);
	LOCATE ,61:PRINT teamItems$(SS%*80+60+X)
	NEXT
	LOCATE 25,1:COLOR 14:PRINT "ESC";:COLOR 15:PRINT "-SELECT NEW ID  PGDN  PGUP  ";:COLOR 14:PRINT "ENTER";:COLOR 15:PRINT "-SELECTS TEAM";
	LOCATE 4,1:COLOR 0,7:PRINT teamItems$(SS%*80+1);:COLOR 15,4

1108 X=INT((POS(X)-1)/20)+1:Y=CSRLIN
	'PRINT X,Y

1109 I$=GetKeyPress$
	IF I$=CHR$(0)+"Q" THEN 1110
	IF I$=CHR$(0)+"I" THEN 1120
	IF I$=CHR$(0)+"G" THEN SS%=0:GOTO 1101
	IF I$=CHR$(0)+"O" THEN SS%=TS%:GOTO 1101
	IF I$=CHR$(0)+"H" THEN 1130
	IF I$=CHR$(0)+"M" THEN 1135
	IF I$=CHR$(0)+"P" THEN 1140
	IF I$=CHR$(0)+"K" THEN 1145
	IF I$=CHR$(27) THEN BO%=1:RETURN
	IF I$=CHR$(13) THEN 1190

1110 ' *** PAGE DOWN ***
	IF SS%=TS% THEN 1108
	SS%=SS%+1:GOTO 1101

1120 ' *** PAGE UP ***
	IF SS%=0 THEN 1108
	SS%=SS%-1:GOTO 1101

1130 ' *** CURSOR UP ***
	IF Y<4 THEN 1108
	GOSUB 1150
	Y=Y-1:IF Y<4 THEN Y=4
	GOSUB 1151
	GOTO 1108

1135 ' *** CURSOR RIGHT ***
	IF X=4 THEN 1108
	IF SS%*80+Y-3+(X)*20>NT THEN 1108
	GOSUB 1150
	X=X+1:IF X>=4 THEN X=4
	GOSUB 1151
	GOTO 1108

1140 ' *** CURSOR DOWN ***
	IF Y>=23 THEN 1108
	IF SS%*80+Y+1-3+(X-1)*20>NT THEN 1108
	GOSUB 1150
	Y=Y+1:IF Y>=23 THEN Y=23
	GOSUB 1151
	GOTO 1108

1145 ' *** CURSOR LEFT ***
	IF X=1 THEN 1108
	GOSUB 1150
	X=X-1:IF X<=1 THEN X=1
	GOSUB 1151
	GOTO 1108

1150 LOCATE Y,(X-1)*20+1:COLOR 15,4
	PRINT teamItems$(Y-3+(X-1)*20+SS%*80);
	RETURN

1151 COLOR 0,7:LOCATE Y,(X-1)*20+1
	PRINT teamItems$(Y-3+(X-1)*20+SS%*80);
	COLOR 15,4
	RETURN

1190 T=V%(SS%*80+Y-3+(X-1)*20):GOTO 1480

1380 ON ERROR GOTO 2055

1385 OPEN D$(0)+"PROBBTMS."+YN$ AS #1 LEN=1031
	Y=LOF(1)
	IF Q=0 THEN T=Y/1031+1
	FIELD #1,15 AS Q$(0),15 AS Q$(1)
	FOR I=0 TO 6
	FIELD #1,30+I*2 AS X$,2 AS Q$(I+2)
	NEXT
	FIELD #1,44 AS X$,2 AS Q$(9)
	FOR I=0 TO 34
	FIELD #1,46+I*2 AS X$,2 AS Q$(I+10)
	NEXT
	FOR I=0 TO 14
	FIELD #1,116+I*57 AS X$,15 AS Q$(I*22+45),2 AS Q$(I*22+46)
	FOR I1=0 TO 19
	FIELD #1,133+I*57+I1*2 AS X$,2 AS Q$(I*22+47+I1)
	NEXT
	NEXT
	FIELD #1,971 AS X$,5 AS Q$(375),15 AS Q$(376),40 AS Q$(377)
	LSET Q$(0)=T$(0):LSET Q$(1)=T$(1):FOR I=0 TO 6:LSET Q$(I+2)=MKI$(L%(I)):NEXT
	LSET Q$(9)=MKI$(999)
	FOR I=0 TO 34:LSET Q$(I+10)=MKI$(T%(I)):NEXT
	FOR I=0 TO 14
	LSET Q$(22*I+45)=B$(I,0)
	LSET Q$(22*I+46)=B$(I,1)
	FOR I1=0 TO 19
	LSET Q$(22*I+47+I1)=MKI$(B%(I,I1))
	NEXT
	NEXT
	LSET Q$(375)=T$(2):LSET Q$(376)=T$(3):LSET Q$(377)=T$(4)
	PUT #1,T
CLOSE 1

1425 ON ERROR GOTO 0

1430 GOTO 60

1440 COLOR 15,0:CLS
	JJ=7
	LOCATE 6,8:COLOR 15,4
	Print " " + Chr$(214); STRING$(61,196); Chr$(183) + " ";:FOR II=1 TO JJ:LOCATE 6+II,8
	Print " " + Chr$(186); STRING$(61,32); Chr$(186) + " ";:NEXT
	LOCATE 7+JJ,8
	Print " " + Chr$(211);STRING$(61,196); Chr$(189) + " ";:LOCATE 7,32
	LOCATE ,12:PRINT "ENTER DISK ID: ":PRINT
	LOCATE ,12:PRINT "THE DISK ID IS USUALLY THE LAST TWO DIGITS OF THE"
	LOCATE ,12:PRINT "SEASON DISK YOU ARE PLAYING FROM (IE. 89, 76, 67)."
	LOCATE ,12:PRINT "ABA SEASONS ARE FOLLOWED BY AN 'A' (IE. 75A)."
	LOCATE ,12:PRINT "HIT <ENTER> TO USE PREVIOUS ID"
	LOCATE 7,27:INPUT NY$
	IF NY$="" THEN GOSUB 1102:GOTO 182
	YN$=NY$
	FOR I=1 TO 500:teamItems$(I)="":V%(I)=1:NEXT
	GOSUB 1100

182 IF BO%=1 THEN BO%=0:GOTO 1440

183 LOCATE 2,33:COLOR T%(33),T%(34):PRINT T$(0):COLOR 15,4
	LOCATE ,33:PRINT "ANY CHANGE (YN)";
	I$=GetKeyPress$
	IF UCASE$(I$)="Y" THEN 1440
	GOTO 1530

1480 ON ERROR GOTO 2060
OPEN D$(0)+"PROBBTMS."+YN$ FOR INPUT AS #1
CLOSE 1

1485 OPEN D$(0)+"PROBBTMS."+YN$ AS #1 LEN=1031
	Y=LOF(1)
	FIELD #1,15 AS Q$(0),15 AS Q$(1)
	FOR I=0 TO 6
	FIELD #1,30+I*2 AS X$,2 AS Q$(I+2)
	NEXT
	FIELD #1,44 AS X$,2 AS Q$(9)
	FOR I=0 TO 34
	FIELD #1,46+I*2 AS X$,2 AS Q$(I+10)
	NEXT
	FOR I=0 TO 14
	FIELD #1,116+I*57 AS X$,15 AS Q$(I*22+45),2 AS Q$(I*22+46)
	FOR I1=0 TO 19
	FIELD #1,133+I*57+I1*2 AS X$,2 AS Q$(I*22+47+I1)
	NEXT
	NEXT
	FIELD #1,971 AS X$,5 AS Q$(375),15 AS Q$(376),40 AS Q$(377)
GET #1,T:CLOSE 1
T$(0)=Q$(0):T$(1)=Q$(1):FOR I=0 TO 6:L%(I)=CVI(Q$(I+2)):NEXT
FOR I=0 TO 34:T%(I)=CVI(Q$(I+10)):NEXT
FOR I=0 TO 14
B$(I,0)=Q$(22*I+45)
B$(I,1)=Q$(22*I+46)
FOR I1=0 TO 19
B%(I,I1)=CVI(Q$(22*I+47+I1))
NEXT
B%(I,16)=1:B%(I,17)=1
NEXT
T$(2)=Q$(375):T$(3)=Q$(376):T$(4)=Q$(377)

1486 IF RIGHT$(T$(0),1)=" " THEN T$(0)=LEFT$(T$(0),LEN(T$(0))-1):GOTO 1486

1487 IF RIGHT$(T$(1),1)=" " THEN T$(1)=LEFT$(T$(1),LEN(T$(1))-1):GOTO 1487

1488 IF RIGHT$(T$(2),1)=" " THEN T$(2)=LEFT$(T$(2),LEN(T$(2))-1):GOTO 1488

1489 IF RIGHT$(T$(3),1)=" " THEN T$(3)=LEFT$(T$(3),LEN(T$(3))-1):GOTO 1489

1490 IF RIGHT$(T$(4),1)=" " THEN T$(4)=LEFT$(T$(4),LEN(T$(4))-1):GOTO 1490

1525 ON ERROR GOTO 0
	RETURN

1530 COLOR ,0
	IF Q=2 THEN 1740

1540 GOTO 600

1740 ON ERROR GOTO 2065
	LPRINT CHR$(15):WIDTH "LPT1:",137

1745 LPRINT:LPRINT "DISK ID:"YN$

1750 LPRINT "TEAM NAME: ";T$(0)" "T$(1)

1780 LPRINT USING "RECORD ##";T%(1)+T%(3);:LPRINT "-";:LPRINT USING "##    HOME ##";T%(2)+T%(4),T%(1);
	LPRINT "-";:LPRINT USING "##    ROAD ##";T%(2),T%(3);:LPRINT "-";:LPRINT USING "##";T%(4):LPRINT
	LPRINT "                                                      OFF DEF  TOT"

1790 LPRINT "PLAYER        PS  G  MIN  FGA  FGM  PCT  FTA FTM  PCT REB REB  REB  AST  PF STL BLK  PTS  AVG HI"

1800 FOR I=0 TO 14
	IF B$(I,0)="" OR B$(I,0)="XXX" THEN 1860
	LPRINT LEFT$(B$(I,0),14); TAB(15); B$(I,1); TAB(18);
	LPRINT USING "## #### #### #### ";B%(I,0),B%(I,1),B%(I,2),B%(I,3);
	IF B%(I,2)=B%(I,3) AND B%(I,3)<>0 THEN LPRINT "1.000";
	IF B%(I,2)<>B%(I,3) THEN LPRINT USING ".###";B%(I,3)/B%(I,2);
	LPRINT TAB(42);
	LPRINT USING "### ### ";B%(I,4),B%(I,5);
	IF B%(I,4)=B%(I,5) AND B%(I,5)<>0 THEN LPRINT "1.000 ";
	IF B%(I,4)<>B%(I,5) THEN LPRINT USING ".### ";B%(I,5)/B%(I,4);
	LPRINT TAB(55);
	LPRINT USING "### ### #### #### ### ### ### #### ";B%(I,6),B%(I,7),B%(I,6)+B%(I,7),B%(I,8),B%(I,9),B%(I,11),B%(I,12),B%(I,3)*2+B%(I,5)+B%(I,14);
	LPRINT USING "##.# ##";(B%(I,3)*2+B%(I,5)+B%(I,14))/B%(I,0),B%(I,15)

1860 NEXT
	LPRINT CHR$(18):LPRINT CHR$(12)

1995 ON ERROR GOTO 0

2000 GOTO 60

2010 LOCATE 23,1:PRINT"HIT ANY KEY TO CONTINUE"

2020 I$=GetKeyPress$

2030 RETURN

2055 CLS:PRINT"ERROR:: UNABLE TO WRITE TEAM FILE":PRINT:PRINT"DISK IS EITHER WRITE PROTECTED OR NOT FORMATTED"

2056 PRINT:PRINT:PRINT"DO YOU WISH TO CONTINUE (Y/N)"

2057 I$=GetKeyPress$

2058 IF I$="Y" THEN RESUME 1380

2059 RUN

2060 CLS:PRINT"ERROR:: UNABLE TO READ TEAM FILE":PRINT

2063 CLOSE 1:RESUME 2720

2065 CLS:PRINT"ERROR:: PRINTER NOT READY...CHECK THAT PRINTER IS ON LINE AND LOADED":PRINT

2066 I$=GetKeyPress$

2067 RESUME 1740

2720 BO%=1:RETURN

4000 I$=GetKeyPress$

4001 IF I$="Y" OR I$="y" THEN I=1:GOTO 4005

4002 IF I$="N" OR I$="n" THEN I=0:GOTO 4005

4003 GOTO 4000

4005 RETURN

4010 LOCATE 15:PRINT "14. STEALS ";B%(I,11):RETURN

4015 LOCATE 16:PRINT "15. BLOCKS ";B%(I,12):RETURN

'$INCLUDE: 'KeyInput.BM'
