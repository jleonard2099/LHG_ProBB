DEFINT A-Z
DECLARE SUB SAVESTATFILES ()
DECLARE SUB GETKEY ()
DECLARE SUB BOGUS (X%)
DECLARE SUB NEWSCREEN ()
DECLARE SUB TICKERUPDATE ()
DECLARE FUNCTION EXIST% (FILENAME$)
DECLARE SUB DRAWBOX (I)
DECLARE SUB SHOTSTRING ()
DECLARE FUNCTION FCOUNT% (FSPEC$)
DECLARE FUNCTION GETDRIVE% ()
DECLARE SUB MAMENU (BYVAL ADDRESS%, SELECTION%, START%, COUNT%, EXITCODE%, FILECOLR%, HILITECOLR%, ROWS%, COLUMNS%, SPACING%, ROW%, COLUMN%)

DIM R$(14), TOA%(33), Q$(380), V%(500), V$(500), FT$(1), FR$(1), E%(13)
DIM T(1, 34), B$(3, 5), AA$(1, 14, 1), B%(1, 14, 19), A(1, 14, 25) AS SINGLE, M9(1) AS SINGLE, L%(1, 6), W%(1, 14, 1)
DIM PS$(4), X7(1), F7%(1, 9), CF%(1, 9), GF%(2, 9), OY%(2), OX%(2)
DIM F1(14), S3(14), G4(14), G5(14), D8(6, 6), N0%(2, 2, 4), O0%(1), G9%(1)
DIM D$(5), D2(1), D1(1), ZZ(2, 14), Z1(15) AS SINGLE, HT%(100), O%(100), HO$(100), H$(100)
DIM P7(1), R3(1), T0(1), T1(1), P5(5), P4(5), Z(15) AS SINGLE, W0(1, 14), W1(1, 14), PFA%(33)
DIM B1(1, 4), S(1, 14), V9(14), C1(1, 14), F5%(1, 4), Z2(14, 14) AS SINGLE, W2(1, 14), W3(1, 14)
DIM RB(9), ZF(1), Z5(1), Z6(1), Y$(1), CM$(1), PO$(1), LC$(2), U5$(3)
DIM P$(1), P7$(1), TS$(1), SC$(1), TF(1), P2(1), VG(9), VH(9)
DIM F%(1, 9), PF%(1), TOF%(1), SC(1)
DIM NG%(18), AP%(2), YN$(3), SX%(32, 1, 14)
DIM SX$(32, 1), ST%(32), O$(2), X$(4), PB$(1),QQ(1,8,14,14), QR(1, 7, 14)
DIM RC$(50,4),REC(50,2) AS SINGLE

COMMON SHARED F5%(), A() AS SINGLE, B1(), B%(), F7%(), T(), SX$(), FF$, AP%(), B$(), SX%()
COMMON SHARED ST%(), Q$(), NG%(), YN$(), S(), AP, AD, N, ZZ()
COMMON SHARED W0(), W1(), W%(), Y$(), X1, P$(), AA$(), Z2() AS SINGLE
COMMON SHARED W2(), W3(), Z() AS SINGLE, Z1() AS SINGLE, V9(), R3(), TF()
COMMON SHARED T0(), O%(), HO$(), HT%(), H$(), TG AS SINGLE, HH%
COMMON SHARED FTF AS SINGLE, TOF%(), PF%(), TOA%(), PFA%(), JY , L%(), PO, D1()
COMMON SHARED X7(), FR%, M9() AS SINGLE, U5, P9, GP AS SINGLE, MPG AS SINGLE, CT, X
COMMON SHARED F%(), T, H, P2(), NB%, T1(), D$(), D2(), O$(), O0%()
COMMON SHARED P, D, Z5(), Z6(), U6 AS SINGLE, R$(), NL%, SC(), XY%, SC, X4%
COMMON SHARED CM%, RT%, TMT, P7$(), PS$(), OY%(), OX%(), CF%(), GF%(), TS$()
COMMON SHARED SC$(), FT$(), FR$(), U5$(), LC$(), X$(), PO$(), CM$()
COMMON SHARED EG%,TS%,TE,TTS%, X8,P7(),E%(),PB$(),PB%,NM%,F3,B
COMMON SHARED A1$,B1$,C1$,D1$,E1$,F1$,G1$,H1$,U$,VG(),VH(),JJ,QQ(),QR()
COMMON SHARED PT%,DK%,Z3$,FT%,FB%,PZ%,NT,V$(),V%(),Y2$,PB$
COMMON SHARED HT%

  CLEAR : COLOR 7, 0: CLS
  RANDOMIZE TIMER
  CALL INITIALIZE
  DRIVE% = GETDRIVE%
  IF AP = 1 THEN GOSUB 1300: GOTO 51


24 CLS : COLOR 2: PRINT TAB(29); "SELECT OPENING OPTIONS": PRINT
25 LOCATE 2, 2: COLOR 14: PRINT "(1) "; : COLOR 15: PRINT U5$(U5)
   LOCATE 3, 2: COLOR 14: PRINT "(2) "; : COLOR 15: PRINT "VISITING TEAM: "; : COLOR T(0, 33), T(0, 34): PRINT B$(0, 0): COLOR , 0
   LOCATE 4, 2: COLOR 14: PRINT "(3) "; : COLOR 15: PRINT "HOME TEAM: "; : COLOR T(1, 33), T(1, 34): PRINT B$(1, 0): COLOR , 0
28 LOCATE 5, 2: COLOR 14: PRINT "(4) "; : COLOR 15: PRINT "3-POINT SHOT: "; TS$(XY%)
29 LOCATE 6, 2: COLOR 14: PRINT "(5) "; : COLOR 15: PRINT SC$(SC)
30 LOCATE 7, 2: COLOR 14: PRINT "(6) "; : COLOR 15: PRINT "LOCATION: "; LC$(N)
31 LOCATE 8, 2: COLOR 14: PRINT "(7) "; : COLOR 15: PRINT USING "DISPLAY PAUSE IN SECONDS: ##.#"; U6
32 LOCATE 9, 2: COLOR 14: PRINT "(8) "; : COLOR 15: PRINT "START GAME"
   LOCATE 10, 2: COLOR 14: PRINT "(9) "; : COLOR 15: PRINT PO$(PO)
   LOCATE 11, 2: COLOR 14: PRINT "(0) "; : COLOR 15: PRINT "SAVE SETTINGS"
   LOCATE 12, 2: COLOR 14: PRINT "(A) "; : COLOR 15: PRINT "SHOW SHOT PERCENTAGES: "; P7$(X4%)
   LOCATE 13, 2: COLOR 14: PRINT "(B) "; : COLOR 15: PRINT "HUMAN COACHES WILL: "; CM$(CM%); : LOCATE 1, 1
   LOCATE 14, 2: COLOR 14: PRINT "(C) "; : COLOR 15: PRINT "BONUS AFTER FOUL # "; NB%
   LOCATE 15, 2: COLOR 14: PRINT "(D) "; : COLOR 15: PRINT "NUMBER OF FREE THROWS "; FT$(RT%)
   LOCATE 16, 2: COLOR 14: PRINT "(E) "; : COLOR 15: PRINT "FREE THROW RULES "; FR$(FR%)
   LOCATE 17, 2: COLOR 14: PRINT "(F) "; : COLOR 15: PRINT "PLAY BY PLAY "; PB$(PB%)
   LOCATE 18, 2: COLOR 14: PRINT "NOTE:: "; : COLOR 15: PRINT "BONUS WAS ON 7TH FOUL (UNTIL 72-73), 6TH FOUL (72-73 SEASON)"
   LOCATE , 2: PRINT "       5TH FOUL (1973-74 TO PRESENT"
   LOCATE , 2: COLOR 14: PRINT "NOTE:: "; : COLOR 15: PRINT "UP UNTIL 1972-73, WHEN A TEAM WAS IN THE BONUS, THEY HAD THE CHANCE"
   LOCATE , 2: PRINT "       TO SHOOT 3 FT TO MAKE 2 OR 2 FT TO MAKE 1"
   LOCATE , 2: COLOR 14: PRINT "NOTE:: "; : COLOR 15: PRINT "UP UNTIL 1972-73, ALL FOULS WERE SHOT...UNLIKE THE CURRENT RULES"
   LOCATE , 2: COLOR 14: PRINT "NOTE:: "; : COLOR 15: PRINT "THE 3-PT SHOT WAS USED FOR ALL ABA SEASONS AND NBA SINCE 1979-80"
   LOCATE , 2: COLOR 14: PRINT "NOTE:: "; : COLOR 15: PRINT "THE ABA USED A 30-SEC SHOT CLOCK THROUGH 1973-74";
35 COLOR 7: I$ = INKEY$: IF I$ = "" THEN 35
   IF I$ = CHR$(27) THEN RUN "HELLO.EXE"
   I = VAL(I$)
   IF UCASE$(I$) = "A" THEN I = 11
   IF UCASE$(I$) = "B" THEN I = 12
   IF UCASE$(I$) = "C" THEN I = 13
   IF UCASE$(I$) = "D" THEN I = 14
   IF UCASE$(I$) = "E" THEN I = 15
   IF UCASE$(I$) = "F" THEN I = 16
   IF I < 0 OR I > 16 THEN 35
   IF I = 16 THEN PB% = 1-PB%:GOTO 25
   IF I = 0 THEN I = 10
   ON I GOTO 38, 40, 41, 42, 44, 46, 48, 50, 45, 43, 47, 33, 10, 11, 9
9 FR% = 1 - FR%: GOTO 25
10 NB% = NB% + 1
   IF NB% > 6 THEN NB% = 4
   GOTO 25
11 RT% = 1 - RT%: GOTO 25
38 U5 = U5 + 1: IF U5 > 3 THEN U5 = 0
   GOTO 25
40 P9 = 0: GOSUB 56: GOTO 24
41 P9 = 1: GOSUB 56: GOTO 24
42 XY% = XY% + 1: IF XY% > 1 THEN XY% = 0
   GOTO 28

43 OPEN "DEFAULT" FOR OUTPUT AS #1
   PRINT #1, U5: PRINT #1, XY%: PRINT #1, SC: PRINT #1, N: PRINT #1, PO: PRINT #1, U6: PRINT #1, X4%: PRINT #1, CM%
   PRINT #1, NB%: PRINT #1, RT%: PRINT #1, FR%: PRINT #1, PB%:CLOSE 1
   GOTO 31
44 SC = 1 - SC: GOTO 29
45 PO = 1 - PO: GOTO 32
46 N = N + 1: IF N > 2 THEN N = 1
   GOTO 30
47 X4% = 1 - X4%: GOTO 32
33 CM% = 1 - CM%: GOTO 32
48 LOCATE 8, 32: INPUT U6: IF U6 < 0 THEN 48
   GOTO 24
50 IF B$(0, 0) = "" OR B$(1, 0) = "" THEN 24
   CLS : COLOR 3: JJ = 6: CALL FRAMEBOX: LOCATE 10, 11
   PRINT "IF YOU ARE USING THE 10 MINUTE TICKER OPTION FOR THIS GAME,"
   LOCATE , 11: PRINT "ENTER STARTING TIME FOR GAME IN THIS FORMAT"
   LOCATE , 11: PRINT "(EXAMPLES: 1:00P, 11:30A). OTHERWISE, JUST HIT ENTER": PRINT
   LOCATE , 11: INPUT "START TIME: "; ST$
   L = LEN(ST$)
   IF L = 5 THEN HR = VAL(LEFT$(ST$, 1)): MIN = VAL(MID$(ST$, 3, 2))
   IF L = 6 THEN HR = VAL(LEFT$(ST$, 2)): MIN = VAL(MID$(ST$, 4, 2))
   T$ = RIGHT$(ST$, 1)
   IF UCASE$(T$) = "P" AND LEFT$(ST$, 2) <> "12" THEN HR = HR + 12
   TM = HR * 60 + MIN
   TTS% = INT(TM / 30 - 18)

   CALL SETUPRATINGS

51 IF U5 = 1 THEN CT = 0: GOTO 55
   IF U5 = 2 THEN U5 = 1: CT = 1: GOTO 55
   IF U5 = 3 THEN U5 = 2
55 GOSUB 62

   GOTO 900

56 COLOR 15, 0: CLS
   JJ = 6
   SN = 1: LOCATE 6, 8: COLOR 15, 4
   PRINT " Ö"; STRING$(61, 196); "· "; : FOR II = 1 TO JJ: LOCATE 6 + II, 8
   PRINT " º"; STRING$(61, 32); "º "; : NEXT
   LOCATE 7 + JJ, 8
   PRINT " Ó"; STRING$(61, 196); "½ "; : LOCATE 7, 32
   LOCATE , 12: PRINT "ENTER DISK ID: ": PRINT
   LOCATE , 12: PRINT "THE DISK ID IS USUALLY THE LAST TWO DIGITS OF THE"
   LOCATE , 12: PRINT "SEASON DISK YOU ARE PLAYING FROM (IE. 89, 76, 67)."
   LOCATE , 12: PRINT "ABA SEASONS ARE FOLLOWED BY AN 'A' (IE. 75A)."
   LOCATE , 12: PRINT "HIT <ENTER> TO USE PREVIOUS ID"
   LOCATE 7, 27: INPUT NY$
   IF NY$ = "" THEN CALL TEAMMENU (2, YN$): GOTO 57
   YN$ = NY$
   FOR I = 1 TO 500: V$(I) = "": V%(I) = 1: NEXT
   GOSUB 4100
   CALL TEAMMENU (BO%, YN$)
57 IF BO% = 1 THEN BO% = 0: GOTO 56
58 LOCATE 2, 33: COLOR T(P9, 33), T(P9, 34): PRINT B$(P9, 0): COLOR 15, 4: LOCATE , 33
   PRINT "ANY CHANGE (YN)"; : I$ = INKEY$: IF I$ = "" THEN 58
   IF UCASE$(I$) = "Y" THEN 56
   COLOR 15, 0
   CALL DISABLEPLAYERS
   RETURN
62 FOR I = 0 TO 1
   CLS
   IF UCASE$(LEFT$(P$(1), 1)) <> "A" AND UCASE$(LEFT$(P$(1), 1)) <> "B" THEN 64
   COLOR 15, 0
   PRINT "ENTER STATS DISK FOR ";
   COLOR T(I, 33), T(I, 34)
   PRINT B$(I, 0)
   COLOR 15, 0
   IF AP = 1 THEN 64
   LOCATE 23, 1
   PRINT "PRESS ANY KEY TO CONTINUE";
63 I$ = INKEY$: IF I$ = "" THEN 63
64 Y$(I) = B$(I, 0)

   Q = I
   GOSUB 6585
   M$ = MID$(B$(I, 0), 4, QQ)
   R$ = M$ + "." + LEFT$(B$(I, 0), 2)
   R$ = R$ + "S"
   IF NOT EXIST%(P$(1) + R$) THEN 66
    OPEN P$(1) + R$ FOR INPUT AS #2
    INPUT #2, Y%
    FOR I1 = 1 TO 100: INPUT #2, O%(I1): NEXT
    FOR I1 = 1 TO 100: INPUT #2, HO$(I1): NEXT
    FOR I1 = 1 TO 100: INPUT #2, HT%(I1): NEXT
    FOR I1 = 1 TO 100: INPUT #2, HO$(I1): NEXT
   CLOSE 2
   FOR I1 = 1 TO Y%
   IF O%(I1) > HT%(I1) THEN Z5(I) = Z5(I) + 1
   IF O%(I1) < HT%(I1) THEN Z6(I) = Z6(I) + 1
   NEXT
66 B$(I, 0) = Y$(I)
   NEXT
   RETURN

70 CALL ROSTER
   GOSUB 105
   IF C1 = 1 THEN GOSUB 80: GOTO 73
   FOR I = 0 TO 4
76 LOCATE I + 20, 1
   COLOR 2, 0: PRINT USING "# "; I; : COLOR 15: PRINT "ENTER "; PS$(I); " # ";
72 I$ = INKEY$: IF I$ = "" THEN 72
   IF UCASE$(I$) = "O" OR UCASE$(I$) = "F" OR UCASE$(I$) = "P" THEN GOSUB 100: GOTO 76
   J = VAL(I$): GOSUB 131
   IF J < 0 OR J > 14 OR A(P9, J, 12) >= 6 OR AA$(P9, J, 0) = "XXX" OR B%(P9, J, 18) <> 0 THEN 72
   FOR I2 = 0 TO 4: IF B1(P9, I2) = J THEN 72
   NEXT I2
   B1(P9, I) = J: Z = J: GOSUB 90: PRINT AA$(P9, J, 0); : LOCATE J + 3 - CV%, 3: COLOR T(P9, 33), T(P9, 34): PRINT LEFT$(AA$(P9, J, 0), 12): COLOR 15, 0
   NEXT
73 LOCATE 25, 1: COLOR 12, 0: PRINT "# TO CHANGE (0-4) 6=NONE";
   LOCATE 1, 1
74 I$ = INKEY$: IF I$ = "" THEN 74
   IF UCASE$(I$) = "O" OR UCASE$(I$) = "F" OR UCASE$(I$) = "P" THEN GOSUB 100: GOTO 74
   I1 = VAL(I$): IF I1 = 6 THEN CLS : RETURN
   IF I1 < 0 OR I1 > 4 THEN 73
   IF X = 50 AND I1 = B AND P9 = P THEN LOCATE 20, 29: COLOR 14, 0: PRINT AA$(P9, B1(P9, I1), 0); " IS AT THE FT LINE": GOTO 73
   LOCATE 25, 1: PRINT "                         ";
   J = B1(P9, I1): Z = J: GOSUB 90: LOCATE J + 3 - CV%, 3: COLOR 15, 0: PRINT LEFT$(AA$(P9, J, 0), 12)
77 LOCATE I1 + 20, 1: PRINT "                          ";
   B1(P9, I1) = -1
   LOCATE , 1: COLOR 2: PRINT USING "# "; I1; : COLOR 15: PRINT "ENTER "; PS$(I1); " # ";
75 I$ = INKEY$: IF I$ = "" THEN 75
   IF UCASE$(I$) = "O" OR UCASE$(I$) = "F" OR UCASE$(I$) = "P" THEN GOSUB 100: GOTO 77
   J = VAL(I$): GOSUB 131
   IF J < 0 OR J > 14 OR A(P9, J, 12) >= 6 OR B%(P9, J, 18) <> 0 OR AA$(P9, J, 0) = "XXX" THEN 75
   FOR I2 = 0 TO 4: IF B1(P9, I2) = J THEN 75
   NEXT I2
   B1(P9, I1) = J: Z = J: GOSUB 90: PRINT AA$(P9, J, 0); : LOCATE J + 3 - CV%, 3: COLOR T(P9, 33), T(P9, 34): PRINT LEFT$(AA$(P9, J, 0), 12): COLOR 15, 0
   GOTO 73
80 FOR M = 0 TO 4
   LOCATE M + 20, 1
   COLOR 2, 0: PRINT USING "# "; M; : COLOR 15, 0: PRINT "ENTER "; PS$(M); " # ";
   Z = B1(P9, M): GOSUB 90
   PRINT AA$(P9, Z, 0); : LOCATE Z + 3 - CV%, 3: COLOR T(P9, 33), T(P9, 34): PRINT LEFT$(AA$(P9, Z, 0), 12): COLOR 15, 0
   NEXT
   RETURN
90 CV% = 0: FOR IP% = 0 TO Z: IF B%(P9, IP%, 18) <> 0 THEN CV% = CV% + 1
    NEXT: RETURN
100 IF UCASE$(I$) = "P" THEN P7(P9) = 1 - P7(P9): GOSUB 105: RETURN
    IF UCASE$(I$) = "F" THEN D2(P9) = D2(P9) + 1: IF D2(P9) > 5 THEN D2(P9) = 1
    IF UCASE$(I$) = "O" THEN O0%(P9) = O0%(P9) + 1: IF O0%(P9) > 2 THEN O0%(P9) = 0
    GOSUB 105: RETURN
105 COLOR 14: LOCATE 19, 29: PRINT "   SELECT OFFENSIVE AND DEFENSIVE STYLE"
    LOCATE 21, 32: COLOR 15: PRINT "O"; : COLOR 3: PRINT "FFENSE STYLE-"; : COLOR 7: PRINT O$(O0%(P9))
    LOCATE 22, 32: COLOR 3: PRINT "DE"; : COLOR 15: PRINT "F"; : COLOR 3: PRINT "ENSE STYLE-"; : COLOR 7: PRINT D$(D2(P9))
    LOCATE 23, 32: COLOR 3: PRINT "FULL COURT "; : COLOR 15: PRINT "P"; : COLOR 3: PRINT "RESS-"; : COLOR 7: PRINT P7$(P7(P9))
    RETURN
131 IF UCASE$(I$) = "A" THEN J = 10
    IF UCASE$(I$) = "B" THEN J = 11
    IF UCASE$(I$) = "C" THEN J = 12
    IF UCASE$(I$) = "D" THEN J = 13
    IF UCASE$(I$) = "E" THEN J = 14
    RETURN
150 GOSUB 1200
    RETURN

159 GOSUB 698
    CALL NEWSCREEN
    RETURN

170 T = 0
    TF(0) = TF(0) + P2(0)
    TF(1) = TF(1) + P2(1)
    CALL QUARTERTOTAL
    H = H + 1

    GOSUB 275
    XS = 1
    P2(0) = 0
    P2(1) = 0
    X = 0
    U$ = "END OF QUARTER!"
    IF PB% = 0 THEN CALL DELAY
    IF PB% = 1 AND U6 <> 0 THEN CALL WINDEX:PRINT U$:CALL MOREDELAY
    GOSUB 178
    IF H < 5 AND U5 <> 0 THEN GOSUB 175
    IF H < 5 THEN GOSUB 159: B = -1: GOSUB 220: T = 720: CALL UPDATESCREEN: GOTO 250
    GOSUB 159
    IF H = 5 THEN U$ = "END OF REGULATION"
    IF H = 5 AND PB% = 0 THEN CALL DELAY
    IF H = 5 AND PB% = 1 AND U6 <> 0 THEN CALL WINDEX:PRINT U$:CALL MOREDELAY
    IF S(0, 0) = S(1, 0) AND PB% = 0 THEN U$ = "OVERTIME !!!": CALL DELAY
    IF S(0, 0) = S(1, 0) AND PB% = 1 THEN CALL WINDEX: PRINT "OVERTIME !!!":CALL MOREDELAY
    IF S(0, 0) = S(1, 0) THEN 190
    CALL GETKEY
    GOTO 8400

175 IF U5 = 1 THEN P9 = CT: CALL COMPUTERSUBS
    IF U5 = 2 THEN P9 = 0: CALL COMPUTERSUBS: P9 = 1: CALL COMPUTERSUBS
    RETURN

178 IF H = 3 AND PB% = 0 THEN U$ = "HALFTIME!": CALL DELAY: GOSUB 8515
    IF H = 3 AND PB% = 1 THEN CALL WINDEX: PRINT "HALFTIME!": GOSUB 8515
    RETURN

190 T1(0) = T1(0) + 1: T1(1) = T1(1) + 1: T = 300: ZF(0) = 0: ZF(1) = 0: CALL UPDATESCREEN: B = -1: GOSUB 220: GOTO 250
210 M5 = 0: IF T <= 2 OR IN = 99 THEN M5 = 2: GOTO 214
    IF T > 2 AND T <= 4 THEN M5 = 2
    IF T > 4 AND T <= 16 THEN M5 = INT(RND(1) * 2) + 3
    IF T > 16 THEN M5 = INT(RND(1) * 2) + 4: REM:CHANGED AFTER DEF RB CHANGE FROM +4 TO +3
214 TE = M5: GOSUB 365: T = T - M5: IN = 0: X8 = X8 - M5
    IF T <= .001 THEN TE = T: GOSUB 365: T = 0
    IF X8 <= 0 THEN X8 = 0
    CALL UPDATESCREEN
    RETURN
220 NL% = 1
    A1$ = ""
    B1$ = ""
    C1$ = ""
    D1$ = ""
    E1$ = ""
    F1$ = ""
    G1$ = ""
    H1$ = ""
    GOSUB 927
    FO = 0
    GOSUB 4090
    LOCATE 10
    IF U5 = 2 THEN S2 = 0: P9 = P: C1 = 2: GOSUB 698: CALL RATINGTABLES: RETURN
    LOCATE 10, 1: COLOR 15, 0
    PRINT "<ENTER>-CONTINUE"
    PRINT "1-SUB "; B$(P, 0)
    PRINT "2-SUB "; B$(D, 0)
221 I$ = INKEY$: IF I$ = "" THEN 221
    P3 = VAL(I$)
    IF P3 < 1 OR P3 > 2 OR U5 = 1 AND P3 = 1 AND P = CT OR U5 = 1 AND P3 = 2 AND D = CT THEN S2 = 0: P9 = P: C1 = 2: GOSUB 698: CALL RATINGTABLES: GOTO 227
    IF P3 = 1 THEN S2 = P
    IF P3 = 2 THEN S2 = D
    C1 = 1: P9 = S2: GOSUB 70: GOSUB 150: P9 = P: LC% = 1: GOTO 220
227 IF LC% = 1 THEN LC% = 0: GOSUB 159
    GOSUB 4090: RETURN

230 REM
    FOR P9 = 0 TO 1
    IF U5 = 1 AND P9 = CT OR U5 = 2 THEN CALL COMPUTERSUBS: GOTO 243
    GOSUB 70
    GOSUB 150
243 NEXT P9
    CALL RATINGTABLES

    GOSUB 159

    CALL RATINGTABLES

250 GOSUB 850
    IF H < 1 AND H > 5 THEN 252
    P = INT(RND(1) * 2): JB = P
252 IF P = 0 THEN D = 1
    IF P = 1 THEN D = 0
    GOSUB 3000: GOSUB 210
    IF T <= 0 THEN TE = T: GOSUB 365: T = 0: CALL UPDATESCREEN: GOTO 170
    GOSUB 1033
    IF H = 1 OR H > 4 THEN
       IF PB% = 0 THEN U$ = B$(JB, 0) + " GETS THE JUMP":CALL DELAY
       IF PB% = 1 AND U6<>0 THEN CALL WINDEX:COLOR T(JB,33),T(JB,34):PRINT B$(JB,0);:COLOR 15,0:PRINT " GETS THE JUMP":CALL MOREDELAY
       P9 = JB
       P = JB
       GOTO 300
    END IF
    IF PB% = 0 THEN U$ = B$(JB, 0) + " INBOUNDS THE BALL":CALL DELAY
    IF PB% = 1 AND U6<>0 THEN CALL WINDEX:COLOR T(JB,33),T(JB,34):PRINT B$(JB,0);:COLOR 15,0:PRINT " INBOUNDS THE BALL":CALL MOREDELAY
    P9 = JB
    P = JB
    GOTO 300


260 GOSUB 4090
    LOCATE 8, 1
    IF P7(D) = 1 THEN
       IF PB% = 0 THEN U$ = B$(D, 0) + " IS PRESSING":CALL DELAY
       IF PB% = 1 AND U6<>0 THEN CALL WINDEX:COLOR T(D,33),T(D,34):PRINT B$(D,0);:COLOR 15,0:PRINT " IS PRESSING":CALL MOREDELAY
       P1 = 1
    END IF
    RETURN
275 REM:*** ADJUST TIMEOUTS ***
    IF H < 4 THEN 281
    FOR PG = 0 TO 1
    IF T1(PG) > 4 THEN T1(PG) = 4
    IF H > 4 THEN T1(PG) = 3
    NEXT
281 RETURN
300 ST = 0: FO = 0: LS = 0: XS = 0: IF X8 > 0 AND X8 < SC(SC) THEN X8 = X8 - 5: GOTO 302
    X8 = SC(SC): LS = 0: GOSUB 835: IF T < 6 AND LT <> 4 THEN LS = 4
302 D6 = 0: PASS% = 1: A4 = 0: A6 = 0: F = 0: IF X <> 90 THEN X = 0
    IF X <> 90 THEN X = 0
    GOTO 400

350 PASS% = PASS% + 1
    P6 = 0
    A4 = 0
    D6 = 0
    A6 = 1
    F = 0
    X = 0
    GOTO 400

359 S = INT(RND(1) * 100) + 1
    W%(P, B1(P, B), 1) = W%(P, B1(P, B), 1) + 1
    A(P, B1(P, B), 7) = A(P, B1(P, B), 7) + 1
    PT% = 3
    CALL MAKEPBP
    CALL DELAY
    IF S <= F3S% THEN 363
IF PB% = 1 AND U6 <> 0 THEN
       CALL WINDEX
       PRINT "3 PT FG MISSED BY "; AA$(P, B1(P, B), 0)
       CALL MOREDELAY
    END IF
    IF PB% = 0 THEN
       PT% = 5
       CALL MAKEPBP
       CALL DELAY
    END IF
    GOSUB 1033
    T = T - 4
    TE = 4
    GOSUB 365
    IF T <= 0 THEN TE = T: GOSUB 365: T = 0: CALL UPDATESCREEN: GOTO 170
    CALL UPDATESCREEN
    GOTO 670

363 REM: MADE 3-POINT FIELD GOAL
    IF PB% = 1 AND U6<>0 THEN
       CALL WINDEX
       PRINT "3 PT FG GOOD BY "; AA$(P, B1(P, B), 0);" !!!"
       CALL MOREDELAY
    END IF
    IF PB% = 0 THEN
       PT% = 4
       CALL MAKEPBP
       CALL DELAY
    END IF
    CALL MOREDELAY
    S(P, H) = S(P, H) + 3
    S(P, 0) = S(P, 0) + 3
    W%(P, B1(P, B), 0) = W%(P, B1(P, B), 0) + 1
    A(P, B1(P, B), 8) = A(P, B1(P, B), 8) + 1
    GOSUB 1054
    CALL UPDATESCREEN
    GOTO 562

365 REM:*** INCREMENT MINUTES ***
    FOR I3 = 0 TO 1
    FOR I4 = 0 TO 4
    ZZ(I3, B1(I3, I4)) = ZZ(I3, B1(I3, I4)) + TE
    NEXT: NEXT
    RETURN

400 A4 = 0: D6 = 0: P3 = 0: B = INT(RND(1) * 5)
    GOSUB 405
    IF P1 = 1 THEN 428
    R0 = INT(RND(1) * 1000) + 1
    ON D2(D) GOTO 461, 477, 494, 461, 477: REM*** BRANCH TO AREA BASED ON DEFENSE ***

405 R0 = INT(RND(1) * 100) + 1
    IF U5 = 0 AND CM% = 1 OR U5 = 1 AND D = CT AND CM% = 1 OR U5 = 1 AND P = CT OR U5 = 2 THEN 1040
    IF R0 <= 40 THEN 424
    B = INT(RND(1) * 5)
    GOTO 427
424 IF U6<>0 AND PB%=0 THEN U$="PASS TO CHOICE (0-4)":CALL DELAY
    IF U6<>0 AND PB%=1 THEN
       IF AP=1 AND U5=2 OR U6=0 THEN 425
       CALL WINDEX
       PRINT "PASS TO CHOICE (0-4)"
       CALL DELAY
    END IF
425 I$ = INKEY$: IF I$ = "" THEN 425
    IF UCASE$(I$) = "T" THEN CALL TICKER: GOTO 425
    IF UCASE$(I$) = "S" THEN CALL SCOUTREPORT: GOTO 425
    IF UCASE$(I$) = "Q" THEN RUN "HELLO.EXE"
    IF UCASE$(I$) = "Z" OR I$ = "/" THEN CALL CHANGESTRATEGY (I$): GOTO 425
    B = VAL(I$): IF B < 0 OR B > 4 THEN 424
427 RETURN

428 P1 = 0: R0 = INT(RND(1) * 1000) + 1
    IF R0 <= 3 THEN 511
    IF R0 <= 50 THEN 512
    IF R0 <= 50 + F7%(P, 1) + F7%(D, 2) THEN 515
    P9 = INT(RND(1) * 5)
    IF R0 <= 40 + F7%(P, 1) + F7%(D, 2) + A(D, B1(D, P9), 5) + F7%(P, 0) THEN 513
    GOTO 465

    REM:***BAD SHOT ***
437 A4 = 0: R0 = INT(RND(1) * 3) + 1
    IF A(P, B1(P, B), 0) > 60 AND R0 = 1 THEN F = 24
    IF A(P, B1(P, B), 0) > 60 AND R0 = 2 THEN F = 30
    IF A(P, B1(P, B), 0) > 60 AND R0 = 3 THEN F = 36
    IF A(P, B1(P, B), 0) <= 60 AND R0 = 1 THEN F = A(P, B1(P, B), 0) * .4
    IF A(P, B1(P, B), 0) <= 60 AND R0 = 2 THEN F = A(P, B1(P, B), 0) * .5
    IF A(P, B1(P, B), 0) <= 60 AND R0 = 3 THEN F = A(P, B1(P, B), 0) * .6
    PZ% = 1
    X = 0: GOTO 520
445 IF H = 4 AND T <= 120 OR H > 4 THEN 446
    IF A(P, B1(P, B), 3) - A(P, B1(P, B), 7) - A(P, B1(P, B), 11) - A(P, B1(P, B), 12) <= 0 THEN 437
446 REM:*** CHECKING 3-POINT SHOT ***
    IF XY% = 0 THEN 448
    F3S% = 0
    RN = INT(RND(1) * 100) + 1
    IF RN <= A(P, B1(P, B), 19) THEN PZ% = 4: F3S% = A(P, B1(P, B), 20) + F7%(D, 4): F3S% = F3S% + INT(RND(1) * 7) - 3: X = 0: GOTO 520
    IF P6 = 4 AND INT(RND(1) * 100) + 1 <= 20 THEN 437
    IF P6 = 4 THEN PZ% = 4: X = 0: F3S% = .4 * A(P, B1(P, B), 20) + F7%(D, 4): GOTO 520
    IF H >= 4 AND T < 30 AND S(D, 0) - S(P, 0) > 3 AND A(P, B1(P, B), 19) >= 3 THEN PZ% = 4: X = 0: F3S% = A(P, B1(P, B), 20) + F7%(D, 4): GOTO 520
448 REM:*** CHECKING FOR ASSISTED SHOT ***
    GOSUB 920: A4 = INT(RND(1) * 41)
    R0 = INT(RND(1) * F5%(P, 4)) + 1: RN = INT(.17 * F5%(P, 4) + .5)
    IF RN >= R0 THEN F = F + A4: PZ% = 2: X = 0: GOTO 520
    REM:*** CHECK PENETRATION SHOT ***
    RN = INT(RND(1) * 100) + 1: A4 = INT(RND(1) * 50) + 1
    IF RN <= (B%(P, B1(P, B), 16) + OY%(O0%(P))) * 2 + 1 THEN PZ% = 3: F = F + A4: X = 0: GOTO 520
    REM:*** CHECK AVERAGE SHOT ***
    I2 = B%(P, B1(P, B), 16): RN = INT(RND(1) * 2)
    IF LEFT$(AA$(P, B1(P, B), 1), 1) = "G" OR LEFT$(AA$(P, B1(P, B), 1), 1) = "F" THEN 453
    IF RN = 1 THEN 452
    PZ% = 5: F = F + CF%(RN, I2): X = 0: GOTO 520
452 PZ% = 6: F = F + CF%(RN, I2): X = 0: GOTO 520
453 RN = INT(RND(1) * 3)
    IF RN = 1 THEN 454
    IF RN = 2 THEN 457
    PZ% = 5: F = F + GF%(RN, I2): X = 0: GOTO 520
454 PZ% = 6: F = F + GF%(RN, I2): X = 0: GOTO 520
457 PZ% = 7: F = F + GF%(RN, I2): X = 0: GOTO 520

461 REM:*** SHOT VS REG/TIGHT M-M ***
    IF R0 <= 2 THEN 511
    IF R0 <= 30 THEN 512
    IF R0 <= 30 + F7%(P, 1) + F7%(D, 2) THEN 515
    P9 = INT(RND(1) * 5)
    IF R0 <= 24 + F7%(P, 1) + F7%(D, 2) + A(D, B1(D, P9), 5) + F7%(P, 0) + OX%(O0%(P)) THEN 513
465 R0 = INT(RND(1) * 1000) + 1
    IF (PASS% <= 3 OR PASS% > 4) AND R0 <= 320 + ((JY - 89) * 10) THEN 445
    IF PASS% = 4 THEN 445
    GOTO 437
477 REM:*** SHOT VS LOOSE/SAG M-M ***
    IF R0 <= 1 THEN 511
    IF R0 <= 10 THEN 512
    IF R0 <= 10 + F7%(P, 1) + F7%(D, 2) THEN 515
    P9 = INT(RND(1) * 5)
    IF R0 <= 8 + F7%(P, 1) + F7%(D, 2) + A(D, B1(D, P9), 5) + F7%(P, 0) + OX%(O0%(P)) THEN 513
    GOTO 465
494 REM:*** SHOT VS TRAP M-M ***
    IF R0 <= 3 THEN 511
    IF R0 <= 50 THEN 512
    IF R0 <= 50 + F7%(P, 1) + F7%(D, 2) THEN 515
    P9 = INT(RND(1) * 5)
    IF R0 <= 40 + F7%(P, 1) + F7%(D, 2) + A(D, B1(D, P9), 5) + F7%(P, 0) + OX%(O0%(P)) THEN 513
    GOTO 465
511 X = 0: GOTO 580

512 GOSUB 210: GOSUB 1033: CALL UPDATESCREEN: X = 88: GOTO 565
513 GOSUB 210
    GOSUB 1033
    A(P, B1(P, B), 23) = A(P, B1(P, B), 23) + 1
    IF U6 = 0 THEN 500
    IF PB% = 1 THEN
       CALL WINDEX
       PRINT "BALL STOLEN BY ";AA$(D, B1(D, P9), 0); "!"
       CALL MOREDELAY
       GOTO 500
    END IF
    RN = INT(RND(1) * 100) + 1
    IF RN<=3 THEN U$ = AA$(D, B1(D, P9), 0) + " QUICKLY REACHES IN!":CALL DELAY
    IF RN>3 AND RN<=6 THEN U$ = AA$(D, B1(D, P9), 0) + " SNEAKS IN FROM BEHIND!":CALL DELAY
    IF RN>6 AND RN<=10 THEN U$ = AA$(D, B1(D, P9), 0) + " GETS A HAND ON THE BALL!":CALL DELAY

    RN = INT(RND(1) * 20) + 1

    IF RN = 1 THEN U$ = "PASS INTERCEPTED BY " + AA$(D, B1(D, P9), 0) + "!"
    IF RN = 2 THEN U$ = "PASS IS PICKED OFF BY " + AA$(D, B1(D, P9), 0) + "!"
    IF RN = 3 THEN U$ = "BALL IS STOLEN BY " + AA$(D, B1(D, P9), 0) + "!"
    IF RN = 4 THEN U$ = AA$(D, B1(D, P9), 0) + " WITH THE STEAL!"
    IF RN = 5 THEN U$ = AA$(D, B1(D, P9), 0) + " TAKES IT AWAY!"
    IF RN = 6 THEN U$ = AA$(D, B1(D, P9), 0) + " STEALS IT!"
    IF RN = 7 THEN U$ = AA$(D, B1(D, P9), 0) + " RIPS IT LOOSE!"
    IF RN = 8 THEN U$ = AA$(D, B1(D, P9), 0) + " TAKES THE BALL AWAY!"
    IF RN = 9 THEN U$ = AA$(D, B1(D, P9), 0) + " STEALS THE BALL!"
    IF RN =10 THEN U$ = AA$(D, B1(D, P9), 0) + " PICKS IT OFF!"
    IF RN =11 THEN U$ = AA$(D, B1(D, P9), 0) + " SWIPES THE BALL!"
    IF RN =12 THEN U$ = AA$(D, B1(D, P9), 0) + " WITH THE STOLEN BALL!"
    IF RN =13 THEN U$ = AA$(D, B1(D, P9), 0) + " STRIPS IT AWAY!"
    IF RN =14 THEN U$ = AA$(D, B1(D, P9), 0) + " WITH THE STEAL!"
    IF RN =15 THEN U$ = AA$(D, B1(D, P9), 0) + " SWIPES AND STEALS IT!"
    IF RN =16 THEN U$ = AA$(D, B1(D, P9), 0) + " SNATCHES IT AWAY!"
    IF RN =17 THEN U$ = AA$(D, B1(D, P9), 0) + " QUICKLY REACHES IN!"
    IF RN =18 THEN U$ = AA$(D, B1(D, P9), 0) + " TAKES IT THE OTHER WAY!"
    IF RN =19 THEN U$ = AA$(D, B1(D, P9), 0) + " POKES IT LOOSE!"
    IF RN =20 THEN U$ = AA$(D, B1(D, P9), 0) + " STRIPS IT CLEAN!"

    CALL DELAY
500 A(D, B1(D, P9), 13) = A(D, B1(D, P9), 13) + 1
    T0(P) = T0(P) + 1
    CALL UPDATESCREEN
    C1 = 2: P9 = D
    IF T <= 0 THEN TE = T: GOSUB 365: T = 0: CALL UPDATESCREEN: GOTO 170
    GOSUB 3000: FB% = 1: GOTO 300
515 GOSUB 210: GOSUB 1033: A(P, B1(P, B), 23) = A(P, B1(P, B), 23) + 1: T0(P) = T0(P) + 1
    IF SV% <> 1 THEN PT% = 1: CALL MAKEPBP
    SV% = 0
    IF PB% = 1 AND U6 <> 0 THEN
       CALL WINDEX
       PRINT "TURNOVER BY ";:COLOR T(P,33),T(P,34):PRINT B$(P, 0):COLOR 15,0: CALL MOREDELAY
    END IF
    IF PB% = 0 THEN CALL DELAY
    U$ = "BALL OUT OF BOUNDS TO " + B$(D, 0)
    GOSUB 729
    CALL MOREDELAY
    CALL UPDATESCREEN
    LOCATE 10, 1
    IF T <= 0 THEN TE = T: GOSUB 365: T = 0: CALL UPDATESCREEN: GOTO 170
    GOSUB 3000: GOSUB 220: GOTO 300
520 GOSUB 210
    IF T <= 0 THEN TE = T: GOSUB 365: T = 0: CALL UPDATESCREEN: GOTO 170
    IF PZ% = 4 AND F3S% <= 0 THEN F3S% = 3
    IF U6 = 0 THEN 529
    IF F > 70 AND FB% = 1 AND PASS% = 1 THEN PT% = 6: PZ% = 8: CALL MAKEPBP: CALL DELAY: GOTO 529
    IF AA$(P, B1(P, B), 0) <> PB$ AND PB$ = "" THEN U$ = "PASS TO " + AA$(P, B1(P, B), 0): CALL DELAY
    IF AA$(P, B1(P, B), 0) <> PB$ AND PB$ <> "" THEN PT% = 10: CALL MAKEPBP: CALL DELAY
    IF AA$(P, B1(P, B), 0) = PB$ THEN PT% = 9: CALL MAKEPBP: CALL DELAY
    IF X8 <= 0 THEN U$ = "SHOT CLOCK HAS EXPIRED!": SV% = 1: GOTO 515
    IF X8 < 5 THEN U$ = "SHOT CLOCK DOWN TO" + STR$(X8): CALL DELAY
    PB$ = AA$(P, B1(P, B), 0)
    Z3$ = LEFT$(AA$(P, B1(P, B), 1), 1)
    Y2$ = "HE"
    Y3$ = AA$(D, B1(D, B), 0)
    ON PZ% GOTO 521, 522, 523, 524, 525, 526, 527
521 IF U6 = 0 THEN 601

    RN = INT(RND(1) * 12) + 1
    IF RN = 1 THEN U$ = Y2$ + "'S HEAVILY GUARDED"
    IF RN = 2 THEN U$ = Y2$ + "'S GUARDED"
    IF RN = 3 THEN U$ = Y2$ + "'S GUARDED BY "+Y3$
    IF RN = 4 THEN U$ = Y2$ + " HAS A MAN ON HIM"
    IF RN = 5 THEN U$ = Y2$ + " HAS A DEFENDER ON HIM"
    IF RN = 6 THEN U$ = Y2$ + "'S COVERED"
    IF RN = 7 THEN U$ = Y2$ + " CAN'T GET AROUND THE DEFENDER"
    IF RN = 8 THEN U$ = Y2$ + "'S PRESSURED"
    IF RN = 9 THEN U$ = Y2$ + " HAS NOWHERE TO GO"
    IF RN = 10 THEN U$ = Y2$ + " HAS A HAND IN HIS FACE"
    IF RN = 11 THEN U$ = Y2$ + "'S WATCHED BY "+Y3$
    IF RN = 12 THEN U$ = Y2$ + "'S WORKING ON "+Y3$
601 CALL DELAY
    GOTO 529

522 U$ = Y2$ + " WORKS FREE INSIDE": CALL DELAY: U$ = "HE HAS AN OPEN SHOT": CALL DELAY: GOTO 529
523 IF U6 = 0 THEN 529
    RN = INT(RND(1) * 100) + 1
    IF Z3$ = "C" AND RN <= 25 THEN U$ = Y2$ + " MAKES A MOVE DOWN LOW": CALL DELAY: GOTO 602
    IF Z3$ = "C" AND RN <= 50 THEN U$ = Y2$ + " POSITIONS HIMSELF DOWN LOW": CALL DELAY: GOTO 602
    IF Z3$ = "C" AND RN <= 75 THEN U$ = Y2$ + " POSTS UP UNDERNEATH": CALL DELAY: GOTO 602
    IF Z3$ = "C" THEN U$ = Y2$ + " BACKS IN AGAINST " + AA$(D, B1(D, 4), 0): CALL DELAY
602 IF Z3$ = "C" THEN U$ = "HE HAS A GOOD SHOT INSIDE": CALL DELAY: GOTO 529
    IF Z3$ = "F" AND RN <= 17 THEN U$ = Y2$ + " DRIVES THE BASELINE": CALL DELAY: GOTO 603
    IF Z3$ = "F" AND RN <= 34 THEN U$ = Y2$ + " PENETRATES THE LANE": CALL DELAY: GOTO 603
    IF Z3$ = "F" AND RN <= 50 THEN U$ = Y2$ + " MOVES INSIDE": CALL DELAY: GOTO 603
    IF Z3$ = "F" AND RN <= 67 THEN U$ = Y2$ + " DRIVES THE LANE": CALL DELAY: GOTO 603
    IF Z3$ = "F" AND RN <= 84 THEN U$ = Y2$ + " MOVES INTO THE PAINT": CALL DELAY: GOTO 603
    IF Z3$ = "F" THEN U$ = Y2$ + " DRIVES UNDERNEATH": CALL DELAY
603 IF Z3$ = "F" THEN U$ = "HE'S GOT A GOOD SHOT UNDERNEATH": CALL DELAY: GOTO 529
    IF Z3$ = "G" AND RN <= 25 THEN U$ = Y2$ + " DRIVES THE LANE": CALL DELAY: GOTO 604
    IF Z3$ = "G" AND RN <= 50 THEN U$ = Y2$ + " DRIVES THROUGH THE KEY": CALL DELAY: U$ = "HE'S INTO THE LANE": CALL DELAY: GOTO 604
    IF Z3$ = "G" AND RN <= 75 THEN U$ = Y2$ + " DRIVES TO THE BASKET": CALL DELAY: GOTO 604
    U$ = Y2$ + " DRIVES THROUGH AN OPENING": CALL DELAY
604 U$ = "HE HAS A GOOD SHOT CLOSE IN": CALL DELAY
    GOTO 529
524 U$ = "HE'S OPEN FROM 3-POINT RANGE!": CALL DELAY: GOTO 529
525 U$ = "HE'S OPEN FROM CLOSE RANGE": CALL DELAY: GOTO 529
526 U$ = "HE'S OPEN FROM MEDIUM RANGE": CALL DELAY: GOTO 529
527 U$ = "HE'S OPEN FROM LONG RANGE": CALL DELAY: GOTO 529
529 IF F <= 0 THEN F = 1
    IF F >= 100 THEN F = 100
    IF U6 = 0 THEN 528
    IF PB% = 1 THEN
       CALL WINDEX
       PRINT "PASS TO ";AA$(P, B1(P, B), 0);" OF ";
       COLOR T(P,33),T(P,34)
       PRINT B$(P, 0):COLOR 15,0
    END IF
    IF PB% = 1 AND PZ% <> 4 THEN LOCATE 10: PRINT "SHOT % "; INT(F + .5);
    IF PB% = 1 AND PZ% = 4 THEN LOCATE 10: PRINT "3 PT SHOT % "; INT(F3S% + .5); : PRINT " *"; : GOTO 528
    IF PB% = 1 AND PZ% >= 2 AND PZ% <= 8 THEN PRINT "*";
    IF U6 = 0 OR PB% = 1 THEN 528
    IF PZ% <> 4 THEN LOCATE 8, 41: PRINT USING "SHOT % ###   "; INT(F + .5);
    IF PZ% = 4 THEN LOCATE 8, 41: PRINT USING "SHOT % ###"; INT(F3S% + .5); : PRINT " *"; : GOTO 528
    IF PZ% >= 2 AND PZ% <= 8 THEN LOCATE , 52: PRINT "*";
528 PRINT : IF PB% = 1 AND U6 <> 0 THEN CALL MOREDELAY
    IF U5 <> 0 OR CM% = 1 THEN 949
530 I$ = INKEY$: IF I$ = "" THEN 530
    IF UCASE$(I$) = "T" THEN CALL TICKER: GOTO 530
    IF UCASE$(I$) = "S" THEN CALL SCOUTREPORT: GOTO 530
    IF UCASE$(I$) = "Q" THEN RUN "HELLO.EXE"
    IF UCASE$(I$) = "Z" OR I$ = "/" THEN CALL CHANGESTRATEGY (I$): GOTO 530
    P6 = VAL(I$): IF P6 < 1 OR P6 > 4 THEN P6 = 0
    IF P6 = 4 THEN FT% = 1
532 I$ = INKEY$
    IF UCASE$(I$) = "T" THEN CALL TICKER
    IF UCASE$(I$) = "Z" OR I$ = "/" THEN CALL CHANGESTRATEGY (I$)
    IF UCASE$(I$) = "S" THEN CALL SCOUTREPORT
    IF UCASE$(I$) = "Q" THEN RUN "HELLO.EXE"
    IF VAL(I$) = 3 AND (U5 = 0 OR U5 = 1 AND P = CT) AND H >= 4 AND T < 240 THEN P6 = 3
    IF VAL(I$) = 2 AND (U5 = 0 OR U5 = 1 AND D = CT) AND T1(P) > 0 THEN P6 = 2
    P3 = P6: IF P6 = 2 AND T1(P) = 0 THEN 530
    IF P6 = 3 AND H < 4 OR P6 = 3 AND U5 = 1 AND D = CT THEN 530
    IF P6 = 3 AND H = 4 AND T > 240 THEN 530
    REM:
    IF (P6 = 1 OR P6 = 4) AND PZ% = 4 THEN P6 = 4
    ON P6 + 1 GOTO 350, 537, 640, 584, 359
537 REM:*** SHOOT!!! ***
    PT% = 3: CALL MAKEPBP: CALL DELAY
    S = 0
    R0 = INT(RND(1) * 100) + 1
    A(P, B1(P, B), 7) = A(P, B1(P, B), 7) + 1
    IF H > 3 AND T <= 30 AND S(D, 0) - S(P, 0) = 2 OR H > 3 AND T <= 30 AND S(D, 0) - S(P, 0) = 0 THEN 540
    IF R0 <= A(P, B1(P, B), 16) + F7%(D, 3) THEN A(P, B1(P, B), 7) = A(P, B1(P, B), 7) - 1: GOSUB 1033: GOTO 589
540 S = INT(RND(1) * 100) + 1: R0 = (F - 2) * .1
    IF S <= R0 THEN GOSUB 1033: GOTO 610
    IF S <= F - 2 THEN 553
    R0 = INT(RND(1) * 100) + 1
    GOTO 548

545 IF PB% = 1 AND U6 <> 0 THEN
       CALL WINDEX
       PRINT "SHOT MISSED BY "; AA$(P, B1(P, B), 0)
       CALL MOREDELAY
    END IF
    IF PB% = 0 THEN PT% = 8: CALL MAKEPBP: CALL DELAY
    GOSUB 1033
546 T = T - 4
    TE = 4
    GOSUB 365
    IF T <= 0 THEN TE = T: GOSUB 365: T = 0: CALL UPDATESCREEN: GOTO 170
    CALL UPDATESCREEN
    GOTO 670

548 I5 = INT(RND(1) * 100) + 1
    I3 = INT(RND(1) * 5)
    IF I5 > A(D, B1(D, I3), 6) THEN 545
    IF U6 = 0 THEN 554
    IF PB% = 1 THEN
       CALL WINDEX
       PRINT "SHOT BLOCKED BY "; AA$(D, B1(D, I3), 0)
       CALL MOREDELAY
       GOTO 554
    END IF

    RN = INT(RND(1) * 100) + 1
    IF RN <= 10 THEN U$ = AA$(D, B1(D, I3), 0)+" STUFFS THE SHOT!!":GOTO 549
    IF RN <= 15 THEN U$ = "DENIED BY "+ AA$(D, B1(D, I3), 0)+"!!":GOTO 549
    IF RN <= 20 THEN U$ = "ERASED BY "+ AA$(D, B1(D, I3), 0)+"!!":GOTO 549
    IF RN <= 25 THEN U$ = "EXPUNGED BY "+ AA$(D, B1(D, I3), 0)+"!!":GOTO 549
    IF RN <= 30 THEN U$ = "REBUKED BY "+ AA$(D, B1(D, I3), 0)+"!!":GOTO 549
    IF RN <= 35 THEN U$ = "SHOT BLOCKED CLEANLY BY "+ AA$(D, B1(D, I3), 0)+"!!":GOTO 549
    IF RN <= 70 THEN U$ = "SHOT BLOCKED BY "+ AA$(D, B1(D, I3), 0)+"!!":GOTO 549
    IF RN <= 90 THEN U$ = "SHOT REJECTED BY "+ AA$(D, B1(D, I3), 0)+"!!":GOTO 549
    U$ = "SHOT SWATTED OUT BY "+ AA$(D, B1(D, I3), 0)+"!!":GOTO 549
549 CALL DELAY


554 A(D, B1(D, I3), 15) = A(D, B1(D, I3), 15) + 1
    X = 98
    GOTO 546

553 IF DK% = 1 AND PB% = 0 THEN PT% = 2: CALL MAKEPBP: U$ = "STUFF BY "+ AA$(P, B1(P, B), 0) + " !!!": DK% = 0: GOTO 559
    IF DK% = 1 AND PB% = 1 THEN U$ = "STUFF BY "+ AA$(P, B1(P, B), 0) + " !!!": DK% = 0: GOTO 559
    IF PB% = 0 AND PZ% = 8 THEN PT% = 7: CALL MAKEPBP: CALL DELAY: PZ% = 0: GOTO 560
    U$ = "BASKET BY "
    U$ = U$ + AA$(P, B1(P, B), 0) + " !!!"
559 IF PB% = 1 AND U6 <> 0 THEN CALL WINDEX: PRINT U$: CALL MOREDELAY: GOTO 560
    RN = INT(RND(1) * 100) + 1
    IF RN<=50 THEN 561
    RN = INT(RND(1)*22)+1
    IF RN = 1 THEN U$ = "NOTHING BUT THE BOTTOM OF THE NET!"
    IF RN = 2 THEN U$ = "COUNT IT!"
    IF RN = 3 THEN U$ = AA$(P, B1(P, B), 0) + " TICKLES THE TWINE!"
    IF RN = 4 THEN U$ = "NO RIM, NO BOARD, JUST CORD!"
    IF RN = 5 THEN U$ = "GOOD!"
    IF RN = 6 THEN U$ = "YES!"
    IF RN = 7 THEN U$ = "COUNT IT!
    IF RN = 8 THEN U$ = "IT'S GOOD!"
    IF RN = 9 THEN U$ = "BINGO!"
    IF RN = 10 THEN U$ = "IT FALLS!"
    IF RN = 11 THEN U$ = "HE DRAINS IT!"
    IF RN = 12 THEN U$ = "SWISH!"
    IF RN = 13 THEN U$ = "ALL NET!"
    IF RN = 14 THEN U$ = "IT'S THERE!"
    IF RN = 15 THEN U$ = "HE BURIES IT!"
    IF RN = 16 THEN U$ = "IT GOES IN!"
    IF RN = 17 THEN U$ = "RING IT UP!"
    IF RN = 18 THEN U$ = "IT GOES DOWN!"
    IF RN = 19 THEN U$ = "BULLSEYE!"
    IF RN = 20 THEN U$ = "HE SCORES!"
    IF RN = 21 THEN U$ = "HE HAS IT!"
    IF RN = 22 THEN U$ = "HE CONNECTS!"
561 IF PB% = 0 THEN CALL DELAY
560 S(P, H) = S(P, H) + 2
    S(P, 0) = S(P, 0) + 2
    GOSUB 1054
    CALL UPDATESCREEN
    A(P, B1(P, B), 8) = A(P, B1(P, B), 8) + 1

562 U$ = B$(D, 0)+ " BALL AFTER SCORE"
    IF PB% = 1 AND U6 <> 0 THEN
       LOCATE 9, 1
       COLOR T(D,33),T(D,34)
       PRINT B$(D, 0);:COLOR 15,0
       PRINT " BALL AFTER SCORE"
       CALL MOREDELAY
    END IF
    IF PB% = 0 THEN GOSUB 871: CALL DELAY
    GOSUB 1033
    T = T - 4
    TE = 4
    GOSUB 365
    IF T <= 0 THEN TE = T: GOSUB 365: T = 0: CALL UPDATESCREEN: GOTO 170
    CALL UPDATESCREEN: GOSUB 3000: GOSUB 810: GOSUB 260: GOTO 300

565 GOSUB 630
566 IF P2(D) > NB% AND H <= 4 OR P2(D) > 3 AND H > 4 THEN 570
    IF T <= 0 THEN TE = T: GOSUB 365: T = 0: CALL UPDATESCREEN: GOTO 170
    IF FR% = 0 THEN
       GOSUB 220
       GOSUB 4090
       LOCATE 8, 1
       U$ = B$(P, 0) + " BALL AFTER FOUL"
       CALL DELAY
       GOSUB 871
       GOTO 350
    END IF
    CALL UPDATESCREEN
    IF U6 = 0 THEN 571
    IF PB% = 0 THEN
       U$ = "1 FT: " + AA$(P, B1(P, B), 0) + STR$(A(P, B1(P, B), 1)) + " %"
       CALL DELAY
       GOTO 571
    END IF
    CALL WINDEX: COLOR T(P,33),T(P,34):PRINT B$(P, 0):COLOR 15,0
    PRINT "1 FT: "; AA$(P, B1(P, B), 0); " "; A(P, B1(P, B), 1); " %"
571 X = 50
    GOSUB 220
    X = 0
    IF U6 = 0 THEN 572
    IF PB% = 0 THEN
       U$ = "1 FT: " + AA$(P, B1(P, B), 0) + STR$(A(P, B1(P, B), 1)) + " %"
       CALL DELAY
       GOTO 572
    END IF
    CALL WINDEX: COLOR T(P,33),T(P,34):PRINT B$(P, 0):COLOR 15,0
    PRINT "1 FT: "; AA$(P, B1(P, B), 0); " "; A(P, B1(P, B), 1); " %"
572 A(P, B1(P, B), 9) = A(P, B1(P, B), 9) + 1
    F3 = 1
    S = INT(RND(1) * 100) + 1
    FX% = A(P, B1(P, B), 1)
    IF S <= FX% AND PB% = 0 THEN CALL THREEFT
    IF S <= FX% AND PB% = 1 THEN CALL MADEFT
    IF S > FX% AND PB% = 0 THEN CALL BADFT
    IF S > FX% AND PB% = 1 THEN CALL MISSFT
    LT = 0
    IF T <= 0 THEN TE = T: GOSUB 365: T = 0: CALL UPDATESCREEN: GOTO 170
    IF S > FX% THEN 650
    GOSUB 3000
    U$ = B$(P, 0) + " BALL AFTER SCORE"
    CALL SELECTPBP
    GOSUB 871
    GOSUB 810
    B = 6
    X = 0
    GOSUB 260
    GOTO 300


570 IF RT% = 1 AND (P2(D) > NB% AND H <= 4 OR P2(D) > 3 AND H > 4) THEN
       U$ = AA$(P, B1(P, B), 0) + " GETS 3 FT TO MAKE 2..."
    ELSE
       U$ = AA$(P, B1(P, B), 0) + " GETS 2 FREE THROWS..."
    END IF
    CALL DELAY
    GOTO 591

580 GOSUB 210
    GOSUB 1033
    GOSUB 3000
    GOSUB 630
    P2(D) = P2(D) - 1
    B = W5
    IF P2(D) > NB% AND H <= 4 OR P2(D) > 3 AND H > 4 THEN 570
    IF T <= 0 THEN TE = T: GOSUB 365: T = 0: CALL UPDATESCREEN: GOTO 170
    U$ = "OFFENSIVE FOUL"
    IF PB% = 0 THEN CALL DELAY
    IF PB% = 1 AND U6 <> 0 THEN CALL WINDEX: PRINT U$: CALL MOREDELAY
    U$ = B$(P, 0) + " BALL AFTER FOUL"
    GOSUB 729
    GOSUB 871: B = 6: CALL DELAY
    T0(D) = T0(D) + 1: CALL UPDATESCREEN: GOSUB 220: GOSUB 260: GOTO 300
584 IN = 99: GOSUB 210
    IF T <= 0 THEN TE = T: GOSUB 365: T = 0: CALL UPDATESCREEN: GOTO 170
    C1 = 2: P9 = D
    U$ = "DESIGNATED FOULER (0-4)"
    CALL SELECTPBP
    IF U5 = 1 AND D = CT OR U5 = 2 THEN W5 = INT(RND(1) * 5): GOTO 588
586 I$ = INKEY$: IF I$ = "" THEN 586
    W5 = VAL(I$): IF W5 < 0 OR W5 > 4 THEN 586
588 GOSUB 631: X8 = SC(SC): GOTO 566
589 T = T - 4: TE = 4
    GOSUB 365
    CALL UPDATESCREEN
    GOSUB 630
    IF U6 = 0 THEN 591
    IF PB% = 0 AND RT% = 1 AND P2(D) > NB% AND H <= 4 OR P2(D) > 3 AND H > 4 THEN U$ = "3 TO MAKE 2 FT: " + AA$(P, B1(P, B), 0) + STR$(A(P, B1(P, B), 1)) + " %":CALL DELAY:GOTO 591
    IF PB% = 0 THEN U$ = "2 FT: " + AA$(P, B1(P, B), 0) + STR$(A(P, B1(P, B), 1)) + " %": CALL DELAY:GOTO 591
    IF PB% = 1 AND RT% = 1 AND P2(D) > NB% AND H <= 4 OR P2(D) > 3 AND H > 4 THEN
       CALL WINDEX
       PRINT B$(P, 0)
       PRINT "3 TO MAKE 2 FT: ";
       PRINT AA$(P, B1(P, B), 0); "   "; A(P, B1(P, B), 1); " %"
       GOTO 591
    END IF
    IF PB% = 1 THEN CALL WINDEX: PRINT B$(P, 0):PRINT "2 FT: "; AA$(P, B1(P, B), 0); "   "; A(P, B1(P, B), 1); " %"

591 X = 50
    GOSUB 220
    X = 0
    IF U6 = 0 THEN 592
    IF PB% = 0 AND RT% = 1 AND P2(D) > NB% AND H <= 4 OR P2(D) > 3 AND H > 4 THEN U$ = "3 TO MAKE 2 FT: " + AA$(P, B1(P, B), 0) + STR$(A(P, B1(P, B), 1)) + " %":CALL DELAY:GOTO 592
    IF PB% = 0 THEN U$ = "2 FT: " + AA$(P, B1(P, B), 0) + STR$(A(P, B1(P, B), 1)) + " %": CALL DELAY:GOTO 592
    IF PB% = 1 AND RT% = 1 AND P2(D) > NB% AND H <= 4 OR P2(D) > 3 AND H > 4 THEN
       CALL WINDEX
       PRINT B$(P, 0)
       PRINT "3 TO MAKE 2 FT: ";
       PRINT AA$(P, B1(P, B), 0); "   "; A(P, B1(P, B), 1); " %"
       GOTO 592
    END IF
    IF PB% = 1 THEN CALL WINDEX: PRINT B$(P, 0):PRINT "2 FT: "; AA$(P, B1(P, B), 0); "   "; A(P, B1(P, B), 1); " %"

592 CALL MOREDELAY
    NM% = 0
    FOR F3 = 1 TO 3
    S = INT(RND(1) * 100) + 1
    FX% = A(P, B1(P, B), 1)
    IF S <= FX% AND PB% = 0 THEN NM% = NM% + 1:CALL THREEFT
    IF S <= FX% AND PB% = 1 THEN NM% = NM% + 1:CALL MADEFT
    IF S > FX% AND PB% = 0 THEN CALL BADFT
    IF S > FX% AND PB% = 1 THEN CALL MISSFT
    A(P, B1(P, B), 9) = A(P, B1(P, B), 9) + 1
    IF NM% = 2 THEN 596
    IF F3 = 2 AND (RT% = 0 OR RT% = 1 AND (P2(D) <= NB% AND H <= 4 OR P2(D) <= 3 AND H > 4)) THEN 596
    NEXT F3
596 IF T <= 0 THEN TE = T: GOSUB 365: T = 0: CALL UPDATESCREEN: GOTO 170
    IF S > A(P, B1(P, B), 1) THEN 650
    GOSUB 3000
    U$ = B$(P, 0) + " BALL AFTER SCORE"
    CALL SELECTPBP
    GOSUB 871
    GOSUB 810
    B = 6
    X = 0
    GOSUB 260
    GOTO 300

610 T = T - 4: TE = 4: GOSUB 365: CALL UPDATESCREEN
    IF DK% = 1 AND PB% = 0 THEN PT% = 2: CALL MAKEPBP: U$ = "STUFF BY " + AA$(P, B1(P, B), 0): CALL DELAY: DK% = 0: GOTO 617
    IF DK% = 1 AND PB% = 1 THEN CALL WINDEX: PRINT "STUFF BY " + AA$(P, B1(P, B), 0): CALL MOREDELAY: DK% = 0: GOTO 617
    IF PZ% = 8 AND PB% = 0 THEN PT% = 7: CALL MAKEPBP: PZ% = 0: CALL DELAY: GOTO 617
    IF PB% = 0 THEN U$ = "BASKET GOOD BY " + AA$(P, B1(P, B), 0): CALL DELAY
    IF PB% = 1 AND U6 <> 0 THEN CALL WINDEX: PRINT "BASKET GOOD BY " + AA$(P, B1(P, B), 0): CALL MOREDELAY
617 U$ = "... AND HE'S FOULED !!!": GOSUB 729: F3 = 1
    CALL MOREDELAY
    GOSUB 1054
    F3 = 1
    S(P, H) = S(P, H) + 2
    S(P, 0) = S(P, 0) + 2
    A(P, B1(P, B), 8) = A(P, B1(P, B), 8) + 1
    CALL UPDATESCREEN
    GOSUB 630
    IF U6 = 0 THEN 620
    IF PB% = 0 AND RT% = 1 AND P2(D) > NB% AND H <= 4 OR P2(D) > 3 AND H > 4 THEN U$ = "2 TO MAKE 1 FT: " + AA$(P, B1(P, B), 0) + STR$(A(P, B1(P, B), 1)) + " %":CALL DELAY:GOTO 620
    IF PB% = 0 THEN U$ = "1 FT: " + AA$(P, B1(P, B), 0) + STR$(A(P, B1(P, B), 1)) + " %": CALL DELAY:GOTO 620
    IF PB% = 1 AND RT% = 1 AND P2(D) > NB% AND H <= 4 OR P2(D) > 3 AND H > 4 THEN
       CALL WINDEX
       PRINT B$(P, 0)
       PRINT "2 TO MAKE 1 FT: ";
       PRINT AA$(P, B1(P, B), 0); "   "; A(P, B1(P, B), 1); " %"
       GOTO 620
    END IF
    IF PB% = 1 THEN CALL WINDEX: PRINT B$(P, 0):PRINT "1 FT: "; AA$(P, B1(P, B), 0); "   "; A(P, B1(P, B), 1); " %"

620 X = 50: GOSUB 220: X = 0
    IF U6 = 0 THEN 621
    IF PB% = 0 AND RT% = 1 AND P2(D) > NB% AND H <= 4 OR P2(D) > 3 AND H > 4 THEN U$ = "2 TO MAKE 1 FT: " + AA$(P, B1(P, B), 0) + STR$(A(P, B1(P, B), 1)) + " %":CALL DELAY:GOTO 621
    IF PB% = 0 THEN U$ = "1 FT: " + AA$(P, B1(P, B), 0) + STR$(A(P, B1(P, B), 1)) + " %": CALL DELAY:GOTO 621
    IF PB% = 1 AND RT% = 1 AND P2(D) > NB% AND H <= 4 OR P2(D) > 3 AND H > 4 THEN
       CALL WINDEX
       PRINT B$(P, 0)
       PRINT "2 TO MAKE 1 FT: ";
       PRINT AA$(P, B1(P, B), 0); "   "; A(P, B1(P, B), 1); " %"
       GOTO 621
    END IF
    IF PB% = 1 THEN CALL WINDEX: PRINT B$(P, 0):PRINT "1 FT: "; AA$(P, B1(P, B), 0); "   "; A(P, B1(P, B), 1); " %"

621 NM% = 0
    FOR F3 = 1 TO 2
    S = INT(RND(1) * 100) + 1
    FX% = A(P, B1(P, B), 1)
    IF S <= FX% AND PB% = 0 THEN NM% = NM% + 1:CALL THREEFT
    IF S <= FX% AND PB% = 1 THEN NM% = NM% + 1:CALL MADEFT
    IF S > FX% AND PB% = 0 THEN CALL BADFT
    IF S > FX% AND PB% = 1 THEN CALL MISSFT

    A(P, B1(P, B), 9) = A(P, B1(P, B), 9) + 1
    IF NM% = 1 THEN 624
    IF F3 = 1 AND (RT% = 0 OR RT% = 1 AND (P2(D) <= NB% AND H <= 4 OR P2(D) <= 3 AND H > 4)) THEN 624
    NEXT F3

624 IF T <= 0 THEN TE = T: GOSUB 365: T = 0: CALL UPDATESCREEN: GOTO 170
    X = 99: IF S > FX% THEN 670

    GOSUB 3000
    U$ = B$(P, 0) + " BALL AFTER SCORE"
    CALL SELECTPBP
    GOSUB 871
    GOSUB 810
    B = 6
    X = 0
    GOSUB 260
    GOTO 300

630 GOSUB 1065
631 A(D, B1(D, W5), 12) = A(D, B1(D, W5), 12) + 1
    P2(D) = P2(D) + 1
    CALL UPDATESCREEN
    IF A(D, B1(D, W5), 3) - A(D, B1(D, W5), 7) - A(D, B1(D, W5), 11) - A(D, B1(D, W5), 12) = 0 THEN A(D, B1(D, W5), 3) = A(D, B1(D, W5), 3) + 1
    IF A(D, B1(D, W5), 12) < 6 THEN GOSUB 638
    IF A(D, B1(D, W5), 12) >= 6 THEN GOSUB 1000: GOSUB 635
    RETURN

635 IF PB% = 1 AND U6 <> 0 THEN CALL WINDEX: PRINT "FOUL ON "; AA$(D, B1(D, W5), 0): CALL MOREDELAY
    IF PB% = 0 THEN U$ = "FOUL CALLED ON " + AA$(D, B1(D, W5), 0): CALL DELAY
    U$ = "HE HAS JUST FOULED OUT !!!"
    GOSUB 729
    CALL MOREDELAY
    C9 = 9
    IF P2(D) > NB% THEN X = 50
    P3 = 1
    IF U5 = 0 OR U5 = 1 AND D = 1 - CT THEN P9 = D: C1 = 1: GOSUB 70: GOSUB 150: GOSUB 220: CALL NEWSCREEN
    GOSUB 698
    X = 0
    RETURN

638 IF PB% = 1 AND U6 <> 0 THEN
       CALL WINDEX
       PRINT "FOUL ON " AA$(D, B1(D, W5), 0)
       CALL MOREDELAY
       PRINT "HE HAS "; A(D, B1(D, W5), 12)
       CALL MOREDELAY
    END IF
    IF PB% = 0 THEN U$ = "FOUL NUMBER" + STR$(A(D, B1(D, W5), 12)) + " CALLED ON " + AA$(D, B1(D, W5), 0): CALL DELAY
    CALL MOREDELAY
    RETURN


640 IF T1(P) <= 0 THEN 648
    T1(P) = T1(P) - 1
    T = T + M5: TE = -M5: GOSUB 365
    X8 = X8 + M5
    U$ = "TIMEOUT " + B$(P, 0):
    CALL DELAY
    CALL MOREDELAY
    GOSUB 220
648 IF A6 = 0 THEN GOSUB 260: GOTO 300
    GOTO 350
650 A6 = 1: P6 = 0: A4 = 0: D6 = 0: GOSUB 1033: S = 0
    R0 = INT(RND(1) * 100) + 1
    IF H > 3 AND T < 30 AND S(D, 0) - S(P, 0) = 2 AND R0 <= 12 OR H > 3 AND T < 30 AND S(D, 0) - S(P, 0) = 0 AND R0 <= 12 THEN GOSUB 790: GOTO 760
    R0 = INT(RND(1) * 100) + 1
    IF R0 <= 11 THEN FF% = 1: GOTO 707
    IF R0 <= 19 THEN GOSUB 790: GOTO 760
    GOSUB 795: GOTO 800
670 A6 = 1: P6 = 0: A4 = 0: D6 = 0: GOSUB 1033: GOTO 700

698 IF T <= 0 THEN TE = T: GOSUB 365: T = 0: CALL UPDATESCREEN
    RETURN

700 S = 0: A4 = 0: D6 = 0: R0 = INT(RND(1) * 100) + 1
    GG = S(D, 0) - S(P, 0)
    IF R0 <= 12 AND H > 3 AND T < 30 AND (GG = 2 OR GG = 0) THEN 700
    IF R0 <= 1 THEN 725
    IF R0 <= 11 THEN FF% = 1: GOTO 707
    IF R0 <= 19 THEN 750
    IF R0 <= 22 THEN 730
    IF R0 <= 23 AND P6 <> 4 THEN 740
707 GOTO 770
710 IF U6 = 0 THEN 713
    IF PB% = 1 THEN CALL WINDEX: PRINT AA$(D, B1(D, B), 0); " HAS THE DEF REBOUND FOR ": PRINT B$(D, 0); " AND IS FOULED !!!": CALL MOREDELAY: GOTO 713
    U$ = AA$(D, B1(D, B), 0) + " HAS THE DEFENSIVE REBOUND": CALL DELAY
    U$ = "HE'S FOULED !!!": CALL DELAY
    CALL MOREDELAY
713 R3(D) = R3(D) + 1: A(D, B1(D, B), 11) = A(D, B1(D, B), 11) + 1: CALL UPDATESCREEN: GOSUB 3000: GOTO 565
720 U$ = AA$(P, B1(P, B), 0) + " HAS THE OFFENSIVE REBOUND"
    IF PB% = 0 THEN CALL DELAY
    IF PB% = 1 AND U6 <> 0 THEN CALL WINDEX: PRINT U$: PRINT "FOR "; B$(P, 0): CALL MOREDELAY
    U$ = "HE'S FOULED !!!"
    GOSUB 729
    CALL MOREDELAY
    A(P, B1(P, B), 24) = A(P, B1(P, B), 24) + 1
    A(P, B1(P, B), 11) = A(P, B1(P, B), 11) + 1
    R3(P) = R3(P) + 1
    CALL UPDATESCREEN
    GOSUB 630
    GOTO 570

725 IF X = 98 THEN 700
    T0(P) = T0(P) + 1
    U$ = "OFFENSIVE GOAL TENDING"
    IF PB% = 0 THEN CALL DELAY
    IF PB% = 1 AND U6 <> 0 THEN CALL WINDEX: PRINT U$: CALL MOREDELAY
    U$ = "BALL GOES TO " + B$(D, 0)
    GOSUB 729
    CALL MOREDELAY
    GOSUB 3000: GOSUB 220: GOTO 300
730 IF X = 99 THEN 700
    GOSUB 790
    A(P, B1(P, B), 7) = A(P, B1(P, B), 7) + 1
    A(P, B1(P, B), 8) = A(P, B1(P, B), 8) + 1
    A(P, B1(P, B), 11) = A(P, B1(P, B), 11) + 1
    R3(P) = R3(P) + 1
    S(P, H) = S(P, H) + 2
    S(P, 0) = S(P, 0) + 2
    CALL UPDATESCREEN
    IF PB% = 1 AND U6 <> 0 THEN CALL WINDEX: PRINT "TIPPED IN BY "; AA$(P, B1(P, B), 0); "!!!": CALL MOREDELAY
    IF PB% = 0 THEN U$ = AA$(P, B1(P, B), 0) + " TIPS IT IN!!!": CALL DELAY
    CALL MOREDELAY
    GOSUB 3000
    U$ = B$(P, 0) + " BALL AFTER SCORE": GOSUB 871
    GOSUB 729
    GOSUB 810: GOSUB 260
    GOTO 300
740 IF X = 99 THEN 700
    U$ = "DEFENSIVE GOAL TENDING"
    IF PB% = 0 THEN CALL DELAY
    IF PB% = 1 AND U6 <> 0 THEN CALL WINDEX: PRINT U$: CALL MOREDELAY
    CALL MOREDELAY:GOTO 560
750 R0 = INT(RND(1) * 100) + 1: IF R0 <= 32 THEN 752
    R3(D) = R3(D) + 1
    CALL UPDATESCREEN
    U$ = "RB KNOCKED O.B. TO " + B$(D, 0)
    IF PB% = 0 THEN CALL DELAY
    IF PB% = 1 AND U6 <> 0 THEN CALL WINDEX: PRINT U$: CALL MOREDELAY
    CALL MOREDELAY
    GOSUB 220: GOSUB 3000: C1 = 2: P9 = P: GOTO 300

752 R3(P) = R3(P) + 1
    CALL UPDATESCREEN
    U$ = "RB KNOCKED O.B. TO " + B$(P, 0)
    IF PB% = 0 THEN CALL DELAY
    IF PB% = 1 AND U6 <> 0 THEN CALL WINDEX: PRINT U$: CALL MOREDELAY
    CALL MOREDELAY
    GOSUB 220: GOTO 520
760 IF FF% = 1 THEN FF% = 0: GOTO 720
761 A(P, B1(P, B), 24) = A(P, B1(P, B), 24) + 1
    A(P, B1(P, B), 11) = A(P, B1(P, B), 11) + 1
    R3(P) = R3(P) + 1: CALL UPDATESCREEN
    U$ = AA$(P, B1(P, B), 0) + " HAS THE OFFENSIVE REBOUND"
    IF PB% = 0 AND U6 <> 0 THEN CALL DELAY
    IF PB% = 1 AND U6 <> 0 THEN CALL WINDEX: PRINT U$: PRINT "FOR " + B$(P, 0): CALL MOREDELAY
    IF T <= 0 THEN TE = T: GOSUB 365: T = 0: CALL UPDATESCREEN: GOTO 170
    PB$ = AA$(P, B1(P, B), 0)
    R0 = INT(RND(1) * 10) + 1: GOSUB 920
    IF H > 4 OR H = 4 AND T <= 120 THEN 765
    IF A(P, B1(P, B), 3) - A(P, B1(P, B), 7) - A(P, B1(P, B), 11) - A(P, B1(P, B), 12) <= 0 THEN F = F * .6
765 IF R0 <= 8 THEN PZ% = 9: GOTO 537
    GOTO 520
770 RB = 0
    FOR I = 0 TO 9: RB(I) = 0: NEXT
    FOR I = 0 TO 4
    IF H > 4 OR H = 4 AND T <= 120 THEN 773
    IF A(P, B1(P, I), 3) - A(P, B1(P, I), 7) - A(P, B1(P, I), 11) - A(P, B1(P, I), 12) <= 0 THEN RB(I) = RB(I) + A(P, B1(P, I), 21) * .65: RB = RB + A(P, B1(P, I), 21) * .65: GOTO 774
773 RB(I) = RB(I) + A(P, B1(P, I), 21): RB = RB + A(P, B1(P, I), 21)
774 NEXT
    FOR I = 0 TO 4
    IF H > 4 OR H = 4 AND T <= 120 THEN 778
    IF A(1 - P, B1(1 - P, I), 3) - A(1 - P, B1(1 - P, I), 7) - A(1 - P, B1(1 - P, I), 11) - A(1 - P, B1(1 - P, I), 12) <= 0 THEN RB(I + 5) = RB(I + 5) + A(1 - P, B1(1 - P, I), 2) * .5: RB = RB + A(1 - P, B1(1 - P, I), 2) * .5: GOTO 779
778 RB(I + 5) = RB(I + 5) + A(1 - P, B1(1 - P, I), 2): RB = RB + A(1 - P, B1(1 - P, I), 2)
779 NEXT
    RN = RND(1) * RB
    FOR B = 0 TO 9
    IF RN <= RB(B) THEN 786
    RB(B + 1) = RB(B + 1) + RB(B)
    NEXT
    B = INT(RND(1) * 10)
786 IF B <= 4 THEN 761
    B = B - 5: GOTO 800
790 RB = 0: FOR I = 0 TO 4: RB(I) = 0
    XZ = A(P, B1(P, I), 21)
    IF H > 2 OR H = 2 AND T <= 120 THEN 793
    IF A(P, B1(P, I), 3) - A(P, B1(P, I), 7) - A(P, B1(P, I), 11) - A(P, B1(P, I), 12) <= 0 THEN XZ = XZ * .5
793 RB(I) = RB(I) + XZ: RB = RB + XZ
    NEXT
    RN = RND(1) * RB
    FOR B = 0 TO 4
    IF RN <= RB(B) THEN 792
    RB(B + 1) = RB(B + 1) + RB(B)
    NEXT
    B = INT(RND(1) * 5)
792 RETURN
795 RB = 0
    FOR I = 0 TO 4
    RB(I) = 0
    XZ = A(1 - P, B1(1 - P, I), 2)
    IF H > 2 OR H = 2 AND T <= 120 THEN 798
    IF A(1 - P, B1(1 - P, I), 3) - A(1 - P, B1(1 - P, I), 7) - A(1 - P, B1(1 - P, I), 11) - A(1 - P, B1(1 - P, I), 12) <= 0 THEN XZ = XZ * .5
798 RB(I) = RB(I) + XZ: RB = RB + XZ
    NEXT

    RN = RND(1) * RB
    FOR B = 0 TO 4
    IF RN <= RB(B) THEN 804
    RB(B + 1) = RB(B + 1) + RB(B)
    NEXT
    B = INT(RND(1) * 5)
804 RETURN
800 IF FF% = 1 THEN FF% = 0: GOTO 710
    A(D, B1(D, B), 11) = A(D, B1(D, B), 11) + 1
    R3(D) = R3(D) + 1: CALL UPDATESCREEN
    U$ = AA$(D, B1(D, B), 0) + " HAS THE DEFENSIVE REBOUND"
    IF PB% = 0 AND U6 <> 0 THEN CALL DELAY
    IF PB% = 1 AND U6 <> 0 THEN CALL WINDEX: PRINT U$: PRINT "FOR " + B$(D, 0): CALL MOREDELAY
    PB$ = AA$(D, B1(D, B), 0)
    C1 = 2: P9 = D: GOSUB 3000: FB% = 1: GOTO 300
810 NL% = 1: A1$ = "": B1$ = "": C1$ = "": D1$ = "": E1$ = "": F1$ = "": G1$ = "": H1$ = ""
    IF U5 <> 0 THEN GOSUB 927
    IF U5 = 2 OR U5 = 1 AND P = CT THEN S2 = 0: P9 = P: C1 = 2: GOSUB 698: RETURN
    GOSUB 4090: LOCATE 10
    COLOR 15, 0
    PRINT "<ENTER>-CONTINUE"
    PRINT "1-TIMEOUT "; B$(P, 0); "-"; T1(P)
813 I$ = INKEY$: IF I$ = "" THEN 813
    P3 = VAL(I$): IF P3 <> 1 THEN S2 = 0: P9 = P: C1 = 2: GOSUB 698: GOTO 818
    IF P3 = 1 AND T1(P) <= 0 OR P3 = 1 AND P = CT AND U5 = 1 THEN 813
    IF P3 = 1 THEN T1(P) = T1(P) - 1: COLOR 15, 0: GOSUB 220
818 GOSUB 4090: LOCATE 10: RETURN
835 IF P = 0 THEN D = 1: RETURN
    IF P = 1 THEN D = 0: RETURN
850 IF H = 2 AND JB = 0 THEN JB = 1: RETURN
    IF H = 2 AND JB = 1 THEN JB = 0
    IF H = 4 AND JB = 0 THEN JB = 1: RETURN
    IF H = 4 AND JB = 1 THEN JB = 0
    RETURN
871 LOCATE 8, 41: PRINT "            ": RETURN

900 IF AP = 1 THEN N = NG%(2)
    X8 = SC(SC)
    C7 = 1
    LS = 0
    IF T < 6 AND LT = 4 THEN LS = 4
    GOTO 230


920 REM:*** GET SHOT PCT ***
    F = A(P, B1(P, B), 0) + D1(D)
    IF N = P THEN F = F + 2
    IF N <> P AND N <> 2 THEN F = F - 2
    RETURN


927 IF U5 = 2 THEN P9 = 0: GOSUB 930: P9 = 1: GOSUB 930
    IF U5 = 1 THEN P9 = CT: GOSUB 930
    RETURN


930 M1 = 0: M2 = 0: M3 = 0: M4 = 0
    IF U5 = 1 AND P9 = CT AND X = 50 OR U5 = 2 AND P9 = P AND X = 50 THEN 939
    FOR I1 = 0 TO 14
    M6 = A(P9, I1, 3) - A(P9, I1, 7) - A(P9, I1, 11) - A(P9, I1, 12)
    IF H < 4 AND M6 <= 0 OR H = 4 AND T > 120 AND M6 <= 0 THEN M1 = M1 + 1
    IF AA$(P9, I1, 0) = "XXX" OR A(P9, I1, 12) >= 6 OR B%(P9, I1, 18) <> 0 OR H = 1 AND A(P9, I1, 12) >= 2 OR H = 2 AND A(P9, I1, 12) >= 4 OR H = 3 AND A(P9, I1, 12) >= 5 OR H = 4 AND T > 300 AND A(P9, I1, 12) = 5 THEN M2 = M2 + 1
    IF I1 > 4 THEN 937
    M6 = A(P9, B1(P9, I1), 3) - A(P9, B1(P9, I1), 7) - A(P9, B1(P9, I1), 11) - A(P9, B1(P9, I1), 12)
    IF M6 <= 0 AND H < 4 OR M6 <= 0 AND H = 4 AND T > 120 THEN M3 = M3 + 1
    IF AA$(P9, B1(P9, I1), 0) = "XXX" OR A(P9, B1(P9, I1), 12) >= 6 OR B%(P9, B1(P9, I1), 18) <> 0 OR H = 1 AND A(P9, B1(P9, I1), 12) >= 2 OR H = 2 AND A(P9, B1(P9, I1), 12) >= 4 OR H = 3 AND A(P9, B1(P9, I1), 12) >= 5 OR H = 4 AND T > 300 AND A(P9 _
, B1(P9, I1), 12) = 5 THEN M4 = M4 + 1
937 NEXT I1
    IF M3 >= 1 AND 5 - M3 < 15 - M1 OR H = 4 AND T < 120 OR H > 4 OR M4 >= 1 AND M2 < 14 THEN CALL COMPUTERSUBS
939 IF H = 4 AND T <= 120 THEN G9%(P9) = 1
    RETURN

949 IF H >= 4 AND T <= 240 AND S(P, 0) - S(D, 0) > 0 AND U5 = 1 AND P = CT THEN 985
    IF U5 = 2 OR U5 = 1 AND D = CT THEN 980
951 IF T <= 1 OR X8 <= 6 THEN P6 = 1: GOTO 532
    IF T <= 8 AND S(P, 0) - S(D, 0) <= -3 AND H >= 4 THEN P6 = 1: GOTO 532
    IF T <= 20 AND S(P, 0) - S(D, 0) <= -5 AND H >= 4 THEN P6 = 1: GOTO 532
    IF PZ% > 1 THEN P6 = 1: GOTO 532
    P6 = 0: GOTO 532

980 IF T <= 240 AND H >= 4 AND S(P, 0) - S(D, 0) > 10 THEN 983
    REM:IF T<=120 AND H>=4 AND S(P,0)-S(D,0)>4 THEN P6=3:GOTO 532
    IF T <= 30 AND H >= 4 AND S(P, 0) - S(D, 0) > 0 THEN P6 = 3: GOTO 532
983 IF (U5 = 1 OR U5 = 0) AND CM% <> 1 THEN 530
    GOTO 951
985 U$ = STR$(A(P, B1(P, B), 1)) + " FT%  INTENTIONAL FOUL (YN)"
986 I$ = INKEY$: IF I$ = "" THEN 986
    IF UCASE$(I$) = "Y" OR I$ = "3" THEN P6 = 3: GOTO 532
    GOTO 951

1000 M9 = 0
     FOR I3 = 0 TO 14
     IF I3 = B1(D, W5) OR AA$(D, I3, 1) = "XXX" OR B%(D, I3, 18) <> 0 THEN 1002
     M9 = M9 + 1
1002 NEXT
     FOR I3 = 0 TO 14
     IF I3 = B1(D, W5) OR AA$(D, I3, 1) = "XXX" OR B%(D, I3, 18) <> 0 THEN 1003
     IF A(D, I3, 0) <= A(D, B1(D, W5), 0) THEN A(D, I3, 3) = A(D, I3, 3) + INT((A(D, B1(D, W5), 3) / M9) + .5)
1003 NEXT I3
     RETURN


1033 X8 = SC(SC): LS = 4: RETURN

1040 CNT% = 0
1041 CNT% = CNT% + 1
     IF CNT% = 4 THEN 427
     M9 = 0
     B = INT(RND(1) * 5)
     X = INT(RND(1) * 100) + 1
     IF X <= 30 THEN 1046
     FOR I = 0 TO 4
     M8 = INT(B%(P, B1(P, I), 2) / B%(P, B1(P, I), 0) + .5) - A(P, B1(P, I), 7)
     IF M8 <= 0 THEN M8 = 0
     IF M8 <= 0 AND A(P, B1(P, I), 3) - A(P, B1(P, I), 7) - A(P, B1(P, I), 11) - A(P, B1(P, I), 12) > 0 THEN M8 = A(P, B1(P, I), 3) - A(P, B1(P, I), 7) - A(P, B1(P, I), 11) - A(P, B1(P, I), 12)
     IF M8 >= M9 THEN B = I: M9 = M8
     NEXT I
1046 GOTO 1041

1054 REM:CREDIT ASSISTS
     R0 = INT(RND(1) * 100) + 1
     IF R0 > F7%(P, 7) THEN 1061
1055 R0 = INT(RND(1) * F5%(P, 2)) + 1
     W5 = 0
     FOR M8 = 0 TO 4
     W5 = W5 + A(P, B1(P, M8), 25)
     IF R0 <= W5 THEN 1059
     NEXT M8
     M8 = INT(RND(1) * 5)
1059 W5 = M8: LOCATE 7, 25
     IF AA$(P, B1(P, B), 0) <> AA$(P, B1(P, M8), 0) THEN
        A(P, B1(P, M8), 14) = A(P, B1(P, M8), 14) + 1
        GOTO 1061
     END IF
     GOTO 1055

1061 RETURN

1065 W5 = 0: M9 = INT(RND(1) * F5%(D, 0)) + 1
     FOR M8 = 0 TO 4: W5 = W5 + A(D, B1(D, M8), 17)
     IF M9 <= W5 THEN 1069
     NEXT M8
1069 IF M8 < 0 OR M8 > 4 THEN M8 = INT(RND(1) * 5)
     W5 = M8: RETURN
     IF U5 = 1 AND P = CT AND H <= 3 AND T < 30 AND J < 3 THEN GOSUB 1080
     IF U5 = 2 AND H <= 3 AND T < 30 AND J < 3 THEN GOSUB 1080
     IF U5 = 1 AND P = CT AND H >= 4 AND T <= 120 AND J >= 3 AND J <= 9 THEN GOSUB 1080
     IF U5 = 2 AND H >= 4 AND T <= 120 AND J >= 3 AND J <= 9 THEN GOSUB 1080
     RETURN
1080 FOR J = 0 TO 3
     J1 = INT(RND(1) * 5)
     IF A(P, B1(P, J1), 20) > 0 THEN B = J1: GOTO 1084
     NEXT J
1084 RETURN



1200 CLS : A = 0: S2 = 1: S3 = 1: SW = 0: FOR ZZ = 0 TO 4
     IF A(P9, B1(P9, ZZ), 22) = 50 THEN A = A + 1: IF SW = 0 THEN PRINT : PRINT "THE FOLLOWING PLAYER(S) ARE PLAYING SAFE BUT CAN NOW PLAY NORMAL IF YOU WISH": SW = 1
     IF A(P9, B1(P9, ZZ), 22) = 50 AND SW = 1 AND S2 < 6 THEN LOCATE S2 + 3, 1: PRINT S2; "-"; AA$(P9, B1(P9, ZZ), 0): P5(A) = S2: P4(A) = ZZ: S2 = S2 + 1: S3 = S3 + 1
     NEXT ZZ: IF SW = 0 THEN 1214
     A = 1: PRINT : PRINT "Z - CONTINUE"
1206 I$ = INKEY$: IF I$ = "" THEN 1206
     IF UCASE$(I$) = "Z" AND MJ = 0 THEN 1214
     IF UCASE$(I$) = "Z" AND MJ = 25 THEN 1230
     P6 = VAL(I$): IF P6 < 1 OR P6 > (S2 + 1) THEN 1206
     A = P6
     IF P6 = P5(P6) THEN
        A(P9, B1(P9, P4(A)), 17) = A(P9, B1(P9, P4(A)), 17) * 3
        A(P9, B1(P9, P4(A)), 22) = 0
        LOCATE P5(A) + 3, 20
        PRINT AA$(P9, B1(P9, P4(A)), 0); " WILL NOW PLAY NORMAL DEFENSE!"
        CALL RATINGTABLES
        D1(P9) = D1(P9) - 1
        A = A + 1
        MJ = 25
        GOTO 1206
     END IF
1214 A = 0: S2 = 1: FOR ZZ = 0 TO 4
     IF H <= 2 AND A(P9, B1(P9, ZZ), 12) >= 3 AND A(P9, B1(P9, ZZ), 22) = 0 OR A(P9, B1(P9, ZZ), 12) = 5 AND A(P9, B1(P9, ZZ), 22) = 0 THEN
        A = A + 1
        IF S2 = 1 THEN
           CLS
           PRINT
           PRINT "THE FOLLOWING PLAYER(S) CAN BE MADE TO PLAY SAFE IF YOU WISH"
           PRINT
        END IF
     END IF
     IF A = 0 AND ZZ > 3 THEN 1230
     IF S2 = A AND S2 < 6 THEN PRINT S2; "- "; AA$(P9, B1(P9, ZZ), 0): P5(A) = S2: P4(A) = ZZ: S2 = S2 + 1: S3 = S3 + 1
     NEXT ZZ
     A = 1: PRINT : PRINT "Z - CONTINUE"
1220 I$ = INKEY$: IF I$ = "" THEN 1220
     IF UCASE$(I$) = "Z" THEN 1230
     P6 = VAL(I$): IF P6 < 1 OR P6 > (S2 + 1) THEN 1220
     A = P6
     IF P6 = P5(P6) THEN
        A(P9, B1(P9, P4(A)), 17) = INT((A(P9, B1(P9, P4(A)), 17) + 1) / 3)
        A(P9, B1(P9, P4(A)), 22) = 50
        LOCATE P5(A) + 3, 20
        PRINT AA$(P9, B1(P9, P4(A)), 0); " WILL NOW PLAY SAFE!"
        CALL RATINGTABLES
        D1(P9) = D1(P9) + 1
        A = A + 1
        S3 = S3 + 1
        GOTO 1220
     END IF
1230 CLS : MJ = 0
     FO = 99: IF H = 1 AND T = 720 THEN FO = 0
     RETURN
1250 IF H <> 3 THEN RETURN
     FOR I = 0 TO 1: FOR I1 = 0 TO 14
     IF A(I, I1, 22) = 50 THEN A(I, I1, 22) = 0: A(I, I1, 17) = A(I, I1, 17) * 3: D1(I) = D1(I) - 1: MJ = 50
     NEXT I1
     IF MJ = 50 THEN MJ = 0: F5%(I, 0) = 0: FOR I1 = 0 TO 4: F5%(I, 0) = F5%(I, 0) + A(I, B1(I, I1), 17): NEXT I1
     NEXT I
     RETURN

1300 XY% = NG%(3)
     U5 = NG%(8)
     PO = NG%(5)
     SC = NG%(7)
     N = NG%(2)
     U6 = NG%(4) / 10
     CM% = NG%(9)
     NB% = NG%(14): FR% = NG%(11): RT% = NG%(10)
     FOR P9 = 0 TO 1
     I1 = NG%(P9)
     YN$ = YN$(P9)
     CALL GETATEAM(I1, YN$)
     NEXT P9
     CALL SETUPRATINGS
     RETURN




3000 PB$ = "": IF P = 1 THEN P = 0: D = 1: P9 = 0: C1 = 2: RETURN
     IF P = 0 THEN P = 1: D = 0: P9 = 1: C1 = 2: RETURN



4090 IF U6 = 0 THEN 4091
     FOR I = 8 TO 15
     LOCATE I, 1
     PRINT "                                      "
     NEXT I
4091 RETURN


4100 IF UCASE$(LEFT$(P$(0), 1)) <> "A" AND UCASE$(LEFT$(P$(0), 1)) <> "B" THEN RETURN
     CLS : PRINT "MAKE SURE CORRECT TEAMS DISK IS IN DRIVE "; P$(0)
     LOCATE 23, 1: PRINT "PRESS ANY KEY TO CONTINUE"
     CALL GETKEY
     RETURN


6585 FOR XX = 4 TO 11: IF MID$(B$(Q, 0), XX, 1) = " " OR MID$(B$(Q, 0), XX, 1) = "." THEN MID$(B$(Q, 0), XX, 1) = "_"
     NEXT XX
     FOR XX = 12 TO 14: IF MID$(B$(Q, 0), XX, 2) = "ST" THEN MID$(B$(Q, 0), 9, 1) = "_": MID$(B$(Q, 0), 10, 2) = "ST"
     NEXT XX
     QQ = 8: FOR XX = 11 TO 4 STEP -1: IF MID$(B$(Q, 0), XX, 1) = "_" THEN QQ = XX - 4: GOTO 6615
     GOTO 6620
6615 NEXT XX
6620 RETURN



8400 REM:CHECK SPECIAL EVENTS
     CALL RECORDSCHECK
     CALL EVENTS (COUNT, SPECIAL)
     
     IF SPECIAL = 1 THEN
        NM$ = "BOX" + MID$(STR$(COUNT), 2, LEN(STR$(COUNT))) + ".SPC"
        CALL BOX2SPC(NM$)
     END IF

8500 CLS
     COLOR 14: PRINT "(0) "; : COLOR 15: PRINT "STATS TO SCREEN": PRINT
     COLOR 14: PRINT "(1) "; : COLOR 15: PRINT "STATS TO PRINTER": PRINT
     COLOR 14: PRINT "(2) "; : COLOR 15: PRINT "STATS TO TEXT FILE"
     IF AP = 1 AND U5 = 2 THEN X = 2: GOTO 8680
8651 I$ = INKEY$: IF I$ = "" THEN 8651
     X = VAL(I$)
8680 IF X = 1 THEN CALL BOX2PRN: GOTO 8532
     IF X = 2 THEN CALL BOX2FILE: GOTO 8532
     CLS

     IF N <> 2 THEN COLOR T(N, 33), T(N, 34): PRINT "@ "; B$(N, 4): PRINT : COLOR 14, 0
     FOR I = 0 TO 1: PRINT B$(I, 0); TAB(17); STR$(S(I, 1)); TAB(20); STR$(S(I, 2)); TAB(23); STR$(S(I, 3)); TAB(26); STR$(S(I, 4));
     IF S(0, 1) + S(0, 2) + S(0, 3) + S(0, 4) = S(1, 1) + S(1, 2) + S(1, 3) + S(1, 4) THEN PRINT TAB(29); STR$(S(I, 5));
     IF S(0, 1) + S(0, 2) + S(0, 3) + S(0, 4) <> S(1, 1) + S(1, 2) + S(1, 3) + S(1, 4) THEN PRINT TAB(29); "- "; S(I, 0): GOTO 8513
     IF S(0, 1) + S(0, 2) + S(0, 3) + S(0, 4) + S(0, 5) = S(1, 1) + S(1, 2) + S(1, 3) + S(1, 4) + S(1, 5) THEN PRINT TAB(32); STR$(S(I, 6));
     IF S(0, 1) + S(0, 2) + S(0, 3) + S(0, 4) + S(0, 5) <> S(1, 1) + S(1, 2) + S(1, 3) + S(1, 4) + S(1, 5) THEN PRINT TAB(32); "- "; S(I, 0): GOTO 8513
     PRINT TAB(35); "- "; S(I, 0): GOTO 8513
8513 NEXT I
8515 CALL BOGUS(X)
     IF X = 0 THEN CLS
     FOR I = 0 TO 1: COLOR T(I, 33), T(I, 34)
     PRINT B$(I, 0): COLOR 14, 0
     PRINT "NAME"; TAB(14); " MIN   FG- A 3FG- A  FT- A ORB  RB  PT  F   A   B   S  TO"
     FOR I1 = 0 TO 14
     IF ZZ(I, I1) = 0 THEN 8529
     COLOR 15: PRINT AA$(I, I1, 0); TAB(14);
     IF ZZ(I, I1) <> 0 THEN
        PRINT USING "##"; INT(ZZ(I, I1) / 60);
        PRINT ":";
        IF ZZ(I, I1) - INT(ZZ(I, I1) / 60) * 60 > 9 THEN
           PRINT USING "##"; ZZ(I, I1) - INT(ZZ(I, I1) / 60) * 60;
        ELSE
           PRINT "0";
           PRINT USING "#"; ZZ(I, I1) - INT(ZZ(I, I1) / 60) * 60;
        END IF
     END IF
     LOCATE , 21
     PRINT USING "##"; A(I, I1, 8);
     PRINT "-";
     PRINT USING "##"; A(I, I1, 7);
     PRINT USING "  ##"; W%(I, I1, 0);
     PRINT "-";
     PRINT USING "##"; W%(I, I1, 1);
     PRINT USING "  ##"; A(I, I1, 10);
     PRINT "-"; : PRINT USING "##"; A( I, I1, 9);
     PRINT USING "  ##  ## ###  #  ##  ##  ##  ##  ##  ##"; A(I, I1, 24); A(I, I1, 11); A(I, I1, 8) * 2 + A(I, I1, 10) + W%(I, I1, 0); A(I, I1, 12); A(I, I1, 14); A(I, I1, 15); A(I, I1, 13); A(I, I1, 23);
     IF ZZ(I, I1) = 0 THEN LOCATE , 15: PRINT "DNP" ELSE PRINT
     V9(0) = V9(0) + A(I, I1, 8)
     V9(1) = V9(1) + A(I, I1, 7)
     V9(2) = V9(2) + A(I, I1, 10)
     V9(3) = V9(3) + A(I, I1, 9)
     V9(4) = V9(4) + A(I, I1, 11)
     V9(5) = V9(5) + (A(I, I1, 8) * 2) + A(I, I1, 10) + W%(I, I1, 0)
     V9(13) = V9(13) + W%(I, I1, 0)
     V9(14) = V9(14) + W%(I, I1, 1)
     V9(6) = TF(I): REM:V9(6)+A(I,I1,12)
     V9(7) = V9(7) + A(I, I1, 14): V9(8) = V9(8) + A(I, I1, 15): V9(9) = V9(9) + A(I, I1, 13): V9(11) = V9(11) + A(I, I1, 24): V9(12) = V9(12) + A(I, I1, 23)
     V9(10) = V9(10) + ZZ(I, I1)
8529 NEXT I1: IF V9(3) = 0 THEN V9(3) = 1
     PRINT : COLOR 14: PRINT "TOTALS"; : COLOR 15: PRINT TAB(14); INT(V9(10) / 60); : LOCATE , 21: PRINT USING "##"; V9(0); : PRINT "-"; : PRINT USING "###"; V9(1);
     LOCATE , 28: PRINT USING "##"; V9(13); : PRINT "-"; : PRINT USING "##"; V9(14);
     LOCATE , 35: PRINT USING "##"; V9(2); : PRINT "-"; : PRINT USING "##"; V9(3);
     LOCATE , 42: PRINT USING "##  ## ### ##  ##  ##  ##  ##"; V9(11); V9(4); V9(5); V9(6); V9(7); V9(8); V9(9); V9(12)
     PRINT TAB(22); INT(((V9(0) / V9(1)) * 100) + .5); "%"; TAB(35); INT(((V9(2) / V9(3)) * 100) + .5); "%": PRINT
     COLOR 14: PRINT "TOTAL TURNOVERS -"; : COLOR 15: PRINT T0(I)
     COLOR 14: PRINT "TOTAL REBOUNDS  -"; : COLOR 15: PRINT R3(I)
     FOR I2 = 0 TO 14: V9(I2) = 0: NEXT I2
     CALL BOGUS(X)
     IF X = 0 THEN CLS
     NEXT I
     IF H >= 4 THEN EG% = 1: CALL TICKER: EG% = 0
     IF H = 3 THEN HT% = 1: CALL TICKER: HT% = 0
     IF H = 3 THEN GOSUB 1250: RETURN
8532 X = 0
     CLS
     J = 1
     LOCATE 8, 8: COLOR T(1, 33), T(1, 34): PRINT " Ö"; STRING$(61, 196); "· ";
     FOR II = 1 TO J: LOCATE 8 + II, 8: PRINT " º"; STRING$(61, 32); "º "; : NEXT
     LOCATE 9 + J, 8: PRINT " Ó"; STRING$(61, 196); "½ ";
     LOCATE 9, 32
     PRINT "DISPLAY STATS AGAIN (YN)";
     COLOR 15, 0
     IF AP = 1 AND U5 = 2 THEN 8535
8533 I$ = INKEY$: IF I$ = "" THEN 8533
     IF UCASE$(I$) = "Y" THEN 8500
8535 CALL COMPILESTATS
     CLS
     J = 1
     LOCATE 8, 8: COLOR T(1, 33), T(1, 34): PRINT " Ö"; STRING$(61, 196); "· ";
     FOR II = 1 TO J: LOCATE 8 + II, 8: PRINT " º"; STRING$(61, 32); "º "; : NEXT
     LOCATE 9 + J, 8: PRINT " Ó"; STRING$(61, 196); "½ ";
     LOCATE 9, 32
     PRINT "ANOTHER GAME (YN)";
     COLOR 15, 0
     IF AP = 1 THEN 8637
8632 I$ = INKEY$: IF I$ = "" THEN 8632
     IF UCASE$(I$) <> "Y" THEN RUN "HELLO.EXE"
     IF DRIVE% >= 67 THEN 8637
     CLS : PRINT "PLEASE MAKE SURE PROGRAM DISK IS IN DRIVE"
     CALL GETKEY
8637 CLS : PRINT "PLEASE WAIT ...": RUN "PROHOOP.EXE"

729 IF PB% = 0 THEN CALL DELAY
    IF PB% = 1 AND U6 <> 0 THEN PRINT U$: CALL MOREDELAY
    RETURN

